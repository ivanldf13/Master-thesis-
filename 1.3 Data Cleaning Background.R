# Loading useful packages ----
library(dplyr)
library(ggplot2)
library(quanteda)
library(readtext)
library(stringr)
library(tidyr)
library(tidytext)
library(knitr)

# Retrieving and reading the documents to be used ----
Corpus <- readtext("./AR.TXT/*.pdf") 

# Create the Stopwords (ENG) objects ----
stop <- tibble(words = stopwords::data_stopwords_stopwordsiso$en)

# Changing the type of variable for doc_id
Corpus <- Corpus %>% 
  mutate(Year = str_match(string = doc_id, "\\d{4}"),
         Year = as.numeric(Year)) %>% 
  select(-doc_id)


# Cleaning the most salient things to erase, unless punctuation ----
# data.clean.(X) is the file before the unnest function (one text per line), with the 1st layer of
# cleaning (words wrongly written) & lower cases

## Cleaning and creating the data with NO punctuation ----
data.clean.no.punct <- Corpus  %>% 
  mutate(text = str_replace_all(text, "\\n", " "),
         text = str_remove_all(text, "[:punct:]"),
         text = str_remove_all(text, "[:digit:]"),
         text = str_remove_all(text, "_+"),
         text = str_remove_all(text, "(\\$|\\~|c~|\\^|\\£|\\^|<>|<|>|¯|>>|⇒|→|>oo|\\boo\\b|°|±|™|\\+|\\-|\\¥|\\■|\\|)\\w?"),
         text = tolower(text),
         text = str_replace_all(text, "wellbeing", "well-being"),
         text = str_remove_all(text,"\\bwe the rockefeller foundation\\b"),
         text = str_remove_all(text,"wwwrockfoundorg"),
         text = str_remove_all(text,"wwwrockefeller"),
         text = str_replace_all(text, "erice(s)?\\b", "ence\\1"),
         text = str_replace_all(text, "univer\\s*(.|usa)?\\s*sity", "university"),
         # text = str_replace_all(text, "zationseffort", "zations effort"),
         text = str_replace_all(text, "\\b(organi|moderni)\\s+(.|usa)?\\s+zation", "\\1zation"),
         # text = str_replace_all(text, "moderni zation", "modernization"),
         # text = str_replace_all(text, "organi zations", "organizations"),
         # text = str_replace_all(text, "organi usa zation", "organization"),
         text = str_replace_all(text, "appropria(\\s|\\t|\\n)+tions", "appropriations"),
         # text = str_replace_all(text, "appro[:space:]priations", "appropriations"),
         # text = str_replace_all(text, "appro\\n{1,5}priations", "appropriations"),
         text = str_replace_all(text, "\\b(ac|ag|aq)\\spriations", "\\1priations"), 
         # text = str_replace_all(text, "ag priations", "appropriations"), 
         # text = str_replace_all(text, "aq priations", "appropriations"), 
         text = str_remove_all(text, "\\brockefeller foundation\\b"),
         # text = str_replace_all(text, "paulodepart", "paulo depart"),
         # text = str_replace_all(text, "researchdepart", "research depart"),
         text = str_replace_all(text, "\\b(adjust|equip)\\s\\b[pjo]\\b", "\\1"),
         # text = str_replace_all(text, "equip p", "equip"),
         # text = str_replace_all(text, "equip j", "equip"),
         # text = str_replace_all(text, "equip o", "equip"),
         # text = str_replace_all(text, "depart o", "depart"),
         # text = str_replace_all(text, "depart j", "depart"),
         text = str_replace_all(text, "nonallgn", "non alligned"),
         text = str_replace_all(text, "(govern|depart|treat|equip|develop|require|move|impove|endow|employ|install|agree|establish|disburse|adjust|supple|experi|settle|pay|invest|ele|achieve|commit|appoint|docu|arrange|assign)\\sment", "\\1ment"),
         text = str_replace_all(text, "\\b([a-z]{1,12})\\s\\bment(s?)\\b", "\\1ment\\2"),
         text = str_replace_all(text, "devel\\sopment", "development"),
         text = str_replace_all(text, "de\\svelopment", "development"),
         text = str_replace_all(text, " depart\\sments", "departments"),
         # text = str_replace_all(text, "depart ment","department"), 
         # text = str_replace_all(text, "treat ments","treatments"),
         # text = str_replace_all(text, "equip ment","equipment"),
         # text = str_replace_all(text, "develop ment","development"),
         # text = str_replace_all(text, "require ment","requirement"),
         # text = str_replace_all(text, "move ment","movement"),
         # text = str_replace_all(text, "improve ment","improvement"),
         # text = str_replace_all(text, "endow ment","endowment"),
         # text = str_replace_all(text, "employ ment","employment"),
         # text = str_replace_all(text, "install ment","installment"),
         # text = str_replace_all(text, "agree ment","agreement"),
         # text = str_replace_all(text, "establish ment","establisment"),
         # text = str_replace_all(text, "disburse ment","disbursement"),
         # text = str_replace_all(text, "adjust ment","adjustment"),
         # text = str_replace_all(text, "supple ment","supplement"),
         # text = str_replace_all(text, "experi ment","experiment"),
         # text = str_replace_all(text, "settle ment","settlement"),
         # text = str_replace_all(text, "pay ment","payment"),
         # text = str_replace_all(text, "invest ment","investment"),
         # text = str_replace_all(text, "ele ment","element"),
         # text = str_replace_all(text, "achieve ment","achievement"),
         # text = str_replace_all(text, "commit ment","commitment"),
         # text = str_replace_all(text, "appoint ment","appointment"),
         # text = str_replace_all(text, "docu ment","document"),
         # text = str_replace_all(text, "arrange ment","arragement"),
         # text = str_replace_all(text, " assign ment","assignement"),
         text = str_replace_all(text, "\\b([a-z]{0,9})\\s\\bcation(s?)\\b", "\\1cation\\2"),
         text = str_replace_all(text, "telecommun", "telecommuni"),
         # text = str_replace_all(text, "education cation","education"),
         # text = str_replace_all(text, "communi cation","communication"),
         # text = str_replace_all(text, "appli cation","application"),
         # text = str_replace_all(text, "classifi cation","classification"),
         # text = str_replace_all(text, "publi cation","publication"),
         # text = str_replace_all(text, "telecommuni cation", "telecommunication"),
         # text = str_replace_all(text, "qualifi cation", "qualification"),
         # text = str_replace_all(text, "communi cation", "communication"),
         # text = str_replace_all(text, "emergedthe", "emerged the"),
         # text = str_replace_all(text, "worldpopu", "world popu"),
         text = str_replace_all(text, "\\b([a-z]{1,10})\\slation(s?)", "\\1lation\\2"),
         # text = str_replace_all(text, "popu lation", "population"),
         # text = str_replace_all(text, "overpopu lation", "overpopulation"),
         # text = str_replace_all(text, "trans lation", "translation"),
         # text = str_replace_all(text, "re lation", "relation"),
         # text = str_replace_all(text, "inocu lation", "inoculation"),
         # text = str_replace_all(text, "iso lation", "isolation"),
         # text = str_replace_all(text, "specu lation", "speculation"),
         text = str_replace_all(text, "foun\\sdation", "foundation"),
         text = str_replace_all(text, "accomo\\sdation", "accomodation"),
         text = str_replace_all(text, "comis\\sj", "comis"),
         text = str_replace_all(text, "([a-z]{2,9})\\ssion(s?)", "\\1ssion\\2"),
         # text = str_replace_all(text, "commis sion", "commission"),
         # text = str_replace_all(text, "promis sion", "promission"),
         # text = str_replace_all(text, "mis sion", "mission"),
         text = str_replace_all(text, "([a-z]{2,12})\\sion(s?)", "\\1sion\\2"),
         # text = str_replace_all(text, "comprehen sion", "comprehension"),
         # text = str_replace_all(text, "deci sion", "decision"),
         # text = str_replace_all(text, "divi sion", "division"),
         # text = str_replace_all(text, "profe sion", "profesion"),
         # text = str_replace_all(text, "man sion", "mansion"),
         # text = str_replace_all(text, "supervi sion", "supervision"),
         # text = str_replace_all(text, "provi sion", "provision"),
         # text = str_replace_all(text, "mis sions", "missions"),
         # text = str_replace_all(text, "pen sions", "pensions"),
         # text = str_replace_all(text, "exten sions", "extensions"),
         # text = str_replace_all(text, "discu sions", "discusions"),
         text = str_replace_all(text, "foun\\s(a|i)", "foun"),
         # text = str_replace_all(text, "foun i", "foun"),
         text = str_replace_all(text, "con\\struction", "construction"),
         # text = str_replace_all(text, "recon struction", "reconstruction"),
         text = str_replace_all(text, "oo struction", "construction"),
         text = str_replace_all(text, "indebted\\s(a|k)", "indebted"),
         # text = str_replace_all(text, "inthe", "in the"),
         # text = str_replace_all(text, "indebted a", "indebted"),
         # text = str_replace_all(text, "indebted k", "indebted"),
         text = str_replace_all(text, "([a-z]{0,11})\\s\\bness(e?s?)\\b", "\\1ness\\2"), 
         text = str_replace_all(text, "feebleminded ness", "feeblemindedness"),
         # text = str_replace_all(text, "andinterrelated", "and interrelated"),
         # text = str_replace_all(text, "readi ness", "readiness"),
         # text = str_replace_all(text, "dizi ness", "diziness"),
         # text = str_replace_all(text, "blind ness", "blindness"),
         # text = str_replace_all(text, "sick ness", "sickness"),
         # text = str_replace_all(text, "busi ness", "business"),
         # text = str_replace_all(text, "sensitive ness", "sensitiveness"),
         # text = str_replace_all(text, "indebted ness", "indebtedness"),
         # text = str_replace_all(text, "feebleminded ness", "feeblemindedness"),
         # text = str_replace_all(text, "effective ness", "effectiveness"),
         # text = str_replace_all(text, "poor ness", "poorness"),
         # text = str_replace_all(text, "interrelated ness", "interrelatedness"),
         # text = str_replace_all(text, "care ness", "careness"),
         # text = str_replace_all(text, "aware ness", "awareness"),
         # text = str_replace_all(text, "weak nesses", "weaknesses"),
         # text = str_replace_all(text, "internship nesses", "internshipnesses"),
         text = str_replace_all(text, "\\bcom\\sq", "com"),
         text = str_replace_all(text, "\\bcom\\smunit(y|ies)", "communit\\1"),
         # text = str_replace_all(text, "com munity", "community"),
         # text = str_replace_all(text, "com munities", "communities"),
         text = str_replace_all(text, "im\\smunity", "immunity"),
         text = str_replace_all(text, "corpo\\s~", "corpo"),
         
         text = str_replace_all(text, "\\b([a-z]{0,9})\\s\\bration(s?)\\b", "\\1ration\\2"), 
         # text = str_replace_all(text, "corpo ration", "corporation"),
         # text = str_replace_all(text, "prepa ration", "preparation"),
         # text = str_replace_all(text, "explo ration", "exploration"),
         text = str_replace_all(text, "\\badminis\\s>\\sj", "adminis"),
         
         text = str_replace_all(text, "\\b([a-z]{2,9})\\s\\btration(s?)\\b", "\\1tration\\2"),
         # text = str_replace_all(text, "adminis tration", "administration"),
         # text = str_replace_all(text, "concen tration", "concentration"),
         # text = str_replace_all(text, "concen trations", "concentrations"),
         # text = str_replace_all(text, "regis tration", "registration"),
         
         text = str_replace_all(text, "([a-z]{2,10})\\s\\btional(s?)\\b", "\\1tional\\2"),
         # text = str_replace_all(text, "interna tional", "international"),
         # text = str_replace_all(text, "addi tional", "additional"),
         text = str_replace_all(text, "\\b([a-z]{2,10})\\s\\btural(s?)\\b", "\\1tural\\2"),
         # text = str_replace_all(text, "agricul tural", "agricultural"),
         # text = str_replace_all(text, "cul tural", "cultural"),
         # text = str_replace_all(text, "culnj tural", "cultural"),
         # text = str_replace_all(text, "struc tural", "structural"),
         text = str_replace_all(text, "\\b([a-z]{1,11})\\s\\bation(s?)\\b", "\\1ation\\2"),
         # text = str_replace_all(text, "situ ation", "situation"),
         # text = str_replace_all(text, "consider ation", "consideration"),
         # text = str_replace_all(text, "consider ations", "considerations"),
         # text = str_replace_all(text, "appropi ation", "appropriation"),
         # text = str_replace_all(text, "demobiliz ation", "demobilization"),
         # text = str_replace_all(text, "associ ation", "association"),
         # text = str_replace_all(text, "found ation", "foundation"),
         # text = str_replace_all(text, "cooper ation", "cooperation"),
         # text = str_replace_all(text, "programm ation", "programmation"),
         # text = str_replace_all(text, "oper ation", "operation"),
         # text = str_replace_all(text, "oper ations", "operations"),
         # text = str_replace_all(text, "radi ation", "radiation"),
         # text = str_replace_all(text, "cre ation", "creaation"),
         # text = str_replace_all(text, "tax ation", "taxation"),
         # text = str_replace_all(text, "feder ation", "federation"),
         # text = str_replace_all(text, "fund ations", "fundations"),
         
         text = str_replace_all(text, "\\b([a-z]{1,10})\\s\\btation(s?)\\b", "\\1tation\\2"),
         # text = str_replace_all(text, "limi tation", "limitation"),
         # text = str_replace_all(text, "sani tation", "sanitation"),
         # text = str_replace_all(text, "vege tation", "vegetation"),
         # text = str_replace_all(text, "infes tation", "infestation"),
         # text = str_replace_all(text, "documen tation", "documentation"),
         # text = str_replace_all(text, "compu tation", "computation"),
         # text = str_replace_all(text, "compu tations", "computations"),
         # text = str_replace_all(text, "transpor tation", "transportation"),
         # text = str_replace_all(text, "interpre tation", "interpretation"),
         # text = str_replace_all(text, "rehabili tation", "rehabilitation"),
         text = str_replace_all(text, "\\b([a-z]{2,12})\\s\\btion(s?)\\b", "\\1tion\\2"),
         # text = str_replace_all(text, "investiga tion", "investigation"),
         # text = str_replace_all(text, "investiga tions", "investigations"),
         
         text = str_replace_all(text, "\\b([a-z]{1,13})\\s\\bit(y|ies)\\b", "\\1it\\2"),
         # text = str_replace_all(text, "captiv ity", "captivity"),
         # text = str_replace_all(text, "qual ity", "quality"),
         # text = str_replace_all(text, "activ ity", "activity"),
         # text = str_replace_all(text, "commun ity", "community"),
         # text = str_replace_all(text, "calam ity", "calamity"),
         # text = str_replace_all(text, "hered ity", "heredity"),
         # text = str_replace_all(text, "produc ity", "productvity"),
         # text = str_replace_all(text, "valid ity", "validity"),
         # text = str_replace_all(text, "qual ity", "quality"),
         # text = str_replace_all(text, "valid ity", "validity"),
         # text = str_replace_all(text, "objectiv ity", "objectivity"),
         # text = str_replace_all(text, "fertil ity", "fertility"),
         # text = str_replace_all(text, "facil ity", "facility"),
         # text = str_replace_all(text, "insular ity", "insularity"),
         # text = str_replace_all(text, "univers ity", "university"),
         # text = str_replace_all(text, "environmental ity", "environmentality"),
         
         text = str_replace_all(text, "([a-z]{1,12})\\s\\bence(s?)\\b", "\\1ence\\2"),
         # text = str_replace_all(text, "sci ence", "science"),
         # text = str_replace_all(text, "influ ence", "influence"),
         # text = str_replace_all(text, "confe rence", "conference"),
         # text = str_replace_all(text, "refer ence", "reference"),
         # text = str_replace_all(text, "independ ence", "independence"),
         # text = str_replace_all(text, "refer ence", "reference"),
         
         text = str_replace_all(text, "\\b([a-z]{2,11})\\s\\btive(s?)\\b", "\\1tive\\2"),
         
         text = str_replace_all(text, "attenu ated", "attenuated"),
         text = str_replace_all(text, "\\boper ated", "operated"),
         text = str_replace_all(text, "appropri ated", "appropriated"),
         text = str_replace_all(text, "initi ated", "initiated"),
         text = str_replace_all(text, "evalu ated", "evaluated"),
         text = str_replace_all(text, "cre ated", "created"),
         text = str_replace_all(text, "associ ated", "associated"),
         text = str_replace_all(text, "situ ated", "situated"),
         text = str_replace_all(text, "affili oo ated", "affiliated"),
         text = str_replace_all(text, "cooper ated", "cooperated"),
         text = str_replace_all(text, "unaffili", "unaffiliated"),
         text = str_replace_all(text, "exagger ated", "exaggerated"),
         
         text = str_replace_all(text, "jniver ~", "univers"),
         text = str_replace_all(text, "ca lamities", "calamities"),
         text = str_replace_all(text, "accaountantfacil", "accaountant facil "),
         text = str_replace_all(text, "popu atlon", "population"),
         text = str_replace_all(text, "expendi tures", "expenditures"),
         text = str_replace_all(text, "corpoi", "corpor"),
         text = str_replace_all(text, "oper >", "oper"),
         text = str_replace_all(text, "collaboi", "collabor"),
         text = str_replace_all(text, "pos sible", "possible"),
         text = str_replace_all(text, "ap propri", "appropri"),
         text = str_replace_all(text, "populationappropri", "population appropri"),
         text = str_replace_all(text, "admin istration", "administration"),
         text = str_replace_all(text, "expendi ", "expenditures"),
         text = str_replace_all(text, "cd room", "cd-room"),
         text = str_replace_all(text, "nce", "rice"),
         text = str_replace_all(text, "viricent", "vincent"),
         text = str_replace_all(text, "organizuion", "organization"),
         text = str_replace_all(text, "autnoma", "autonoma"),
         text = str_replace_all(text, "ommunities", "communities"),
         text = str_replace_all(text, "ommunity", "community"),
         text = str_replace_all(text, "insurarice", "insurance"),
         text = str_replace_all(text, "ommunities", "communities"),
         text = str_replace_all(text, "californiaa", "california"),
         text = str_replace_all(text, "cccommunity", "community"),
         text = str_replace_all(text, "ccommunity", "community"),
         text = str_replace_all(text, "cccommunities", "communities"),
         text = str_replace_all(text, "ccommunities", "communities"),
         text = str_replace_all(text, "certifi cates", "certificates"),
         text = str_replace_all(text, "cer tificates", "certificates"),
         
         text = str_replace_all(text, "theadvancement", "the advancement"),
         text = str_replace_all(text, "thedevelopment", "the development"),
         text = str_replace_all(text, "thedivision", "the division"),
         text = str_replace_all(text, "thedirection", "the direction"),
         text = str_replace_all(text, "thegovernment", "the government"),
         text = str_replace_all(text, "thecommission", "the commission"), 
         text = str_replace_all(text, "theestablishment", "the establishment"),
         text = str_replace_all(text, "thepopulation", "the population"),
         text = str_replace_all(text, "theimprovement", "the improvement"),
         text = str_replace_all(text, "thereproduction", "the reproduction"),
         text = str_replace_all(text, "theassociation", "the association"),
         text = str_replace_all(text, "thetreatment", "the treatment"), 
         text = str_replace_all(text, "thepreparation", "the preparation"),
         text = str_replace_all(text, "theadvancement", "the advancement"),
         text = str_replace_all(text, "theorganization", "the organization"),
         text = str_replace_all(text, "thecorporation", "the corporation"),
         text = str_replace_all(text, "thedistribution", "the distribution"),
         text = str_replace_all(text, "theintroduction", "the introduction"), 
         text = str_replace_all(text, "thecreation", "the creation"),
         text = str_replace_all(text, "thecooperation", "the cooperation"),
         text = str_replace_all(text, "theinfection", "the infection"),
         text = str_replace_all(text, "theconstruction", "the construction"),
         text = str_replace_all(text, "theapplication", "the application"),
         text = str_replace_all(text, "thesolution", "the solution"),
         text = str_replace_all(text, "theinvestigation", "the investigation"),
         text = str_replace_all(text, "thecompletion", "the completion"),
         text = str_replace_all(text, "thestation", "the station"),
         text = str_replace_all(text, "thepromotion", "the promotion"),
         text = str_replace_all(text, "theuniversity", "the university"),
         text = str_replace_all(text, "thefoundation", "the foundation"),
         text = str_replace_all(text, "thedepartment", "the department"),
         text = str_replace_all(text, "thefoundations", "the foundations"),
         text = str_replace_all(text, "thehumanities", "the humanities"),
         text = str_replace_all(text, "thecity", "the city"),
         text = str_replace_all(text, "theappropriations", "the appropriations"),
         text = str_replace_all(text, "therockefeller", "the rockefeller"),
         text = str_replace_all(text, "theeditors", "the editors"),
         text = str_replace_all(text, "thegrants", "the grants"),
         text = str_replace_all(text, "theblood", "the blood"),
         text = str_replace_all(text, "thecommittee", "the committee"),
         text = str_replace_all(text, "thebureau", "the bureau"),
         text = str_replace_all(text, "theimportant", "the important"),
         text = str_replace_all(text, "theressources", "the ressources"),
         text = str_replace_all(text, "witheressources", "the ressources"),
         text = str_replace_all(text, "theinternational", "the international"),
         text = str_replace_all(text, "thepractice", "the practice"),
         text = str_replace_all(text, "theproject", "the project"),
         text = str_replace_all(text, "theworld", "the world"),
         text = str_replace_all(text, "theinternal", "the internal"),
         text = str_replace_all(text, "thecouncil", "the council"),
         text = str_replace_all(text, "theeconomic", "the economic"),
         text = str_replace_all(text, "thenational", "the national"),
         text = str_replace_all(text, "themedical", "the medical"),
         text = str_replace_all(text, "thework", "the work"),
         text = str_replace_all(text, "thesocial", "the social"),
         text = str_replace_all(text, "thecalifornia", "the california"),
         text = str_replace_all(text, "thestate", "the state"),
         text = str_replace_all(text, "theothers", "the others"),
         
         text = str_replace_all(text, "andequipment", "and equipment"),
         text = str_replace_all(text, "andtreatment", "and treatment"),
         text = str_replace_all(text, "andgovernment", "and government"),
         text = str_replace_all(text, "anddistribution", "and distribution"),
         text = str_replace_all(text, "andfixedequipment", "and fixed equipement"),
         text = str_replace_all(text, "anddevelopment", "and development"),
         text = str_replace_all(text, "andalso", "and also"),
         text = str_replace_all(text, "andcommodities", "and commodities"),
         text = str_replace_all(text, "andeconomic", "and economic"),
         text = str_replace_all(text, "andwomen", "and women"),
         text = str_replace_all(text, "andrelationships", "and relationships"),
         text = str_replace_all(text, "andscientists", "and scientists"),
         text = str_replace_all(text, "andpossibilities", "and possibilities"),
         text = str_replace_all(text, "andexpanded", "and expanded"),
         text = str_replace_all(text, "andaccordingly", "and accordingly"),
         text = str_replace_all(text, "ofinfection", "of infection"),
         text = str_replace_all(text, "ofdevelopment", "of development"),
         text = str_replace_all(text, "offoundation", "of foundation"),
         text = str_replace_all(text, "ofpopulation", "of population"),
         text = str_replace_all(text, "ofequipment", "of equipment"),
         text = str_replace_all(text, "oftreatment", "of treatment"),
         text = str_replace_all(text, "ofnutrition", "of nutrition"),
         text = str_replace_all(text, "ofinvestigations", "of investigations"),
         text = str_replace_all(text, "ofinformation", "of informtion"),
         text = str_replace_all(text, "ofrecognized", "of recognised"),
         text = str_replace_all(text, "ofmedical", "of medical"),
         text = str_replace_all(text, "ofeducation", "of education"),
         text = str_replace_all(text, "ofminorityyouth", "of minority youth"),
         text = str_replace_all(text, "ofhealth", "of health"),
         text = str_replace_all(text, "ofdistinguished", "of distinguished"),
         text = str_replace_all(text, "ofsanitary", "of sanitary"),
         text = str_replace_all(text, "ofresearch", "of research"),
         text = str_replace_all(text, "overthe", "over the"),
         text = str_replace_all(text, "withtheressources", "with the ressources"),
         text = str_replace_all(text, "withmore", "with more"),
         text = str_replace_all(text, "withfoundation", "with foundation"),
         text = str_replace_all(text, "toaccomplish", "to accomplish"),
         text = str_replace_all(text, "tooperate", "to operate"),
         text = str_replace_all(text, "toinequality", "to inequality"),
         text = str_replace_all(text, "toincrease", "to increase"),
         text = str_replace_all(text, "tothe", "to the"),
         text = str_replace_all(text, "toassist", "to assist"),
         text = str_replace_all(text, "aneducation", "an education"),
         text = str_replace_all(text, "anappropriation", "an appropriation"),
         text = str_replace_all(text, "theparticipating", "the participating"),
         text = str_replace_all(text, "afoundation", "a foundation"),
         text = str_replace_all(text, "asingle", "a single"),
         text = str_replace_all(text, "whetherthey", "wether they"),
         text = str_replace_all(text, "foodproduction", "food production"),
         text = str_replace_all(text, "incollaboration", "in collaboration"),
         text = str_replace_all(text, "incooperation", "in cooperation"), 
         text = str_replace_all(text, "inaddition", "in addition"),
         text = str_replace_all(text, "infieldof", "in field of"),
         text = str_replace_all(text, "fordevelopment", "for development"),
         text = str_replace_all(text, "forcollaborative", "for collaborative"),
         text = str_replace_all(text, "foruse", "for use"),
         text = str_replace_all(text, "forthe", "for the"),
         text = str_replace_all(text, "healthdivision", "health division"),
         text = str_replace_all(text, "healthorganization" , "health organization"),
         text = str_replace_all(text, "healthdepartment", "health department"),
         text = str_replace_all(text, "healtheducation", "health education"),
         text = str_replace_all(text, "healthadministration", "health administration"),
         text = str_replace_all(text, "healthcommission", "health commission"),
         text = str_replace_all(text, "highereducation", "higher education"),
         text = str_replace_all(text, "medicaleducation", "medical education"),
         text = str_replace_all(text, "publicadministration", "public administration"),
         text = str_replace_all(text, "foundationfoundation", "foundation"),
         text = str_replace_all(text, "foundationtable", "foundation table"),
         text = str_replace_all(text, "foundationcontents", "foundation contents"),
         text = str_replace_all(text, "foundationgrants", "foundation grants"),
         text = str_replace_all(text, "foundationuniversity", "foundation university"),
         text = str_replace_all(text, "foundationscience", "foundation science"),
         text = str_replace_all(text, "foundationintroductionthe", "foundation
                                introduction the"),
         text = str_replace_all(text, "foundationsystematically", "foundation systematically"),
         text = str_replace_all(text, "foundationsupported", "foundation supported"),
         text = str_replace_all(text, "foundationgrant", "foundation grant"),
         text = str_replace_all(text, "foundationabout", "foundation about"),
         text = str_replace_all(text, "foundationin", "foundation in"),
         text = str_replace_all(text, "foundationadministered", "foundation administered"),
         text = str_replace_all(text, "foundationtion", "foundation"),
         text = str_replace_all(text, "foundationphotograph", "foundation photograph"),
         text = str_replace_all(text, "foundationon", "foundation on"),
         text = str_replace_all(text, "foundationbalarice", "foundation balance"),
         text = str_replace_all(text, "foundationopportunities", "foundation opportunities"),
         text = str_replace_all(text, "soilpollution", "soil pollution"),
         text = str_replace_all(text, "soilshokkaido", "soils hokkaido"),
         text = str_replace_all(text, "wuniversity", "university"),
         text = str_replace_all(text, "universitythe", "university the"),
         text = str_replace_all(text, "univesitythe", "university the"),
         text = str_replace_all(text, "umversidad", "universidad"),
         text = str_replace_all(text, "communitydevelopment", "community development"),
         text = str_replace_all(text, "hookworminfection", "hookworm infection"),
         text = str_replace_all(text, "economicdevelopment", "economic development"),
         text = str_replace_all(text, "reportfoundation", "report foundation"),
         text = str_replace_all(text, "nursingeducation", "nursing education"),
         text = str_replace_all(text, "educationagriculture", "education agriculture"),
         text = str_replace_all(text, "specialattention", "special attention"),
         text = str_replace_all(text, "sciencenutrition", "science nutrition"),
         text = str_replace_all(text, "ruralreconstruction", "rural reconstruction"),
         text = str_replace_all(text, "complementfixation", "complement fixation"), 
         text = str_replace_all(text, "saltflotation", "salt flotation"),
         text = str_replace_all(text, "rockfellerfoundation", "rockfeller foundation"),
         text = str_replace_all(text, "perioduniversity", "period university"),
         text = str_replace_all(text, "grantsuniversity", "grants university"),
         text = str_replace_all(text, "internationalrelations", "international relations"), 
         text = str_replace_all(text, "guniversity", "university"),
         text = str_replace_all(text, "columbiauniversity", "columbia university"),
         text = str_replace_all(text, "hssuniversity", "hss university"),
         text = str_replace_all(text, "paymentsuniversities", "payments universities"),
         text = str_replace_all(text, "forfiveyears", "for five years"),
         text = str_replace_all(text, "highyielding", "high yielding"),
         text = str_replace_all(text, "highquality", "high quality"),
         text = str_replace_all(text, "arthropodborne", "arthropod-borne"),
         text = str_replace_all(text, "nee", "rice"),
         text = str_replace_all(text, "hivaids", "hiv aids"),
         text = str_replace_all(text, "tne", "the"),
         text = str_replace_all(text, "latrines", "latrine"),
         text = str_replace_all(text, "otherexhibition", "other exhibition"),
         text = str_replace_all(text, "rockefellerfoundation", "rockefeller foundation"),
         text = str_replace_all(text, "harvarduniversity", "harvard university"),
         text = str_replace_all(text, "aboveuniversity", "above university"),
         text = str_replace_all(text, "generaleducation", "general education"),
         text = str_replace_all(text, "nonproliferation", "non-proliferation"),
         text = str_replace_all(text, "periodunivkhsity", "period university"),
         text = str_replace_all(text, "varietiestanzania", "varieties tanzania"),
         text = str_replace_all(text, "policieshuman", "policies human"),
         text = str_replace_all(text, "salaamtanzania", "salaam tanzania"),
         text = str_replace_all(text, "salaamfrom", "salaam from"),
         text = str_replace_all(text, "ascomprehensive", "as comprehensive"),
         text = str_replace_all(text, "characterizationbiotechnologyscnpps", 
                                "characterization biotechnology scnpps"),
         text = str_replace_all(text, "associatepatricia", "associate patricia"),
         text = str_replace_all(text, "associatejohn", "associate john"),
         text = str_replace_all(text, "biologyjudge", "biology judge"),
         text = str_replace_all(text, "minoritygroup", "minority group"),
         text = str_replace_all(text, "europeanracial", "european racial"),
         text = str_replace_all(text, "mexicanamerican", "mexican american"),
         text = str_replace_all(text, "peruuniversity", "peru university"),
         text = str_replace_all(text, "japanhokkaido", "japan hokkaido"),
         text = str_replace_all(text, "japangraduate", "japan graduate"),
         text = str_replace_all(text, "japanhague", "japan hague"),
         text = str_replace_all(text, "japaneseunited", "japanese united"),
         text = str_replace_all(text, "colombiauniversity", "colombia university"),
         text = str_replace_all(text, "colombiaversity", "colombia university"),
         text = str_replace_all(text, "brazillaboratory", "brazil laboratory"),
         text = str_replace_all(text, "availableto", "available to"),
         text = str_replace_all(text, "fourfellowships", "four fellowships"),
         text = str_replace_all(text, "valuespririceton", "values princenton"),
         text = str_replace_all(text, "medicineuniversity", "medicine university"),
         text = str_replace_all(text, "facultyof", "faculty of"),
         text = str_replace_all(text, "veterinarymedicine", "veterinary medicine"),
         text = str_replace_all(text, "biologygenetics", "biologoy genetics"),
         text = str_replace_all(text, "developmentsustainable", "development sustainable"),
         text = str_replace_all(text, "projectsupport", "project support"),
         text = str_replace_all(text, "autnoma", "autonoma"),
         text = str_replace_all(text, "darice", "dance"),
         text = str_replace_all(text, "entrarice", "entrance"),
         text = str_replace_all(text, "substarices", "substances"),
         text = str_replace_all(text, "importarice", "importance"),
         text = str_replace_all(text, "coricentrating", "concentrating"),
         text = str_replace_all(text, "periodjapanhokkaido", "period japan hokkaido"),
         text = str_replace_all(text, "sociologydemography", "sociology demography"),
         text = str_replace_all(text, "laboratoryteaching", "laboratory teaching"),
         text = str_replace_all(text, "httpwwwhindustantimescomnewsfeedindiaindiacheersasmonsoonarriveshopesofbetterfarmoutputraisedarticleaspx", 
                                "http www hindustan times com news feed india india cheersas monsoon arrives hopes of better farm out put raised article aspx"),
         text = str_replace_all(text, "resiliericestrategies", "resilience strategies"),
         text = str_replace_all(text, "broadlyshared", "broadly shared"),
         text = str_replace_all(text, "changewhile", "change while"),
         text = str_replace_all(text, "insurariceproducts", "insurance products"),
         text = str_replace_all(text, "themworldand", "them world an"),
         text = str_replace_all(text, "smallholder", "small holder"),
         text = str_replace_all(text, "climatechange", "climate change"),
         text = str_replace_all(text, "activitiesexhibition", "activities exhibition"),
         text = str_replace_all(text, "testimonyvernacular", "testimony vernacular"),
         text = str_replace_all(text, "collaborationand", "collaboration and"),
         text = str_replace_all(text, "providechroreographic", "provide choreographic"),
         text = str_replace_all(text, "anyonesexpextation", "anyones expectation"),
         text = str_replace_all(text, "specialscholarships", "special scholarships"),
         text = str_replace_all(text, "scholarshipassistarice", "scholarship assistance"),
         text = str_replace_all(text, "automaticdrips", "automatic drips"),
         text = str_replace_all(text, "studiesand", "studies and"),
         text = str_replace_all(text, "trainingbases", "training bases"),
         text = str_replace_all(text, "bloodforming", "blood forming"),
         text = str_replace_all(text, "basicbiological", "basic biological"),
         text = str_replace_all(text, "pathologicalthrough", "pathological through"),
         text = str_replace_all(text, "substariceswhich", "substances which"),
         text = str_replace_all(text, "arrangementshave", "arrangement shave"),
         text = str_replace_all(text, "statesintensive", "states intensive"),
         text = str_replace_all(text, "whichhave", "which have"), 
         text = str_replace_all(text, "southernstates", "southern states"), 
         text = str_replace_all(text, "morethat", "more that"),
         text = str_replace_all(text, "theirresponsibility", "their responsibility"),
         text = str_replace_all(text, "degreeof", "degree of"),
         text = str_replace_all(text, "entirerepublic", "entire republic"),
         text = str_replace_all(text, "effectivemethods", "effective methods"),
         text = str_replace_all(text, "averagedegree", "average degree"),
         text = str_replace_all(text, "governmentprivate", "government private"),
         text = str_replace_all(text, "betterqualified", "better qualified"),
         text = str_replace_all(text, "residualspraying", "residual spraying"),
         text = str_replace_all(text, "tworepresentative", "two representative"),
         text = str_replace_all(text, "worldwideusefulness", "worldwide usefullness"),
         text = str_replace_all(text, "favorabletime", "favorable time"),
         text = str_replace_all(text, "methodthe", "method the"),
         text = str_replace_all(text, "authoritieshowever", "authorities however"),
         text = str_replace_all(text, "decreasein", "decrease in"),
         text = str_replace_all(text, "morelimited", "more limited"),
         text = str_replace_all(text, "whichhas", "which has"),
         text = str_replace_all(text, "isan", "is an"),
         text = str_replace_all(text, "truethat", "true that"),
         text = str_replace_all(text, "decadebecomes", "decade becomes"),
         text = str_replace_all(text, "socialsanitary", "social sanitary"),
         text = str_replace_all(text, "theirdistribution", "their distribution"),
         text = str_replace_all(text, "housingfamily", "housing family"),
         text = str_replace_all(text, "problemswhich", "problems which"),
         text = str_replace_all(text, "byfor", "by for"),
         text = str_replace_all(text, "feasabilitypower", "feasability power"),
         text = str_replace_all(text, "prospectthought", "prospect thought"),
         text = str_replace_all(text, "inprogress", "in progress"),
         text = str_replace_all(text, "selfsufficiency", "self sufficiency"),
         text = str_replace_all(text, "providessupport", "provides support"),
         text = str_replace_all(text, "agegroups", "age groups"),
         text = str_replace_all(text, "proposedpersonal", "proposed personal"),
         text = str_replace_all(text, "scholarsphilanthropic", "scholars philanthropic"),
         text = str_replace_all(text, "noeconomic", "no economic"),
         text = str_replace_all(text, "journalismeducationberkeley", 
                                "journalism education berkeley"),
         text = str_replace_all(text, "towardsits", "towards its"),
         text = str_replace_all(text, "numberof", "number of"),
         text = str_replace_all(text, "newspaperindustry", "newspaper industry economic"),
         text = str_replace_all(text, "robinsonfoundationnew", 
                                "robinson foundation new"),
         text = str_replace_all(text, "fundadevelopment", "fund a development"),
         text = str_replace_all(text, "citizensexpanding", "citizens expanding"),
         text = str_replace_all(text, "businesscollaboratweprogramsaimedat", 
                                "business collaborat we programs aimed at"),
         text = str_replace_all(text, "improvingyouth", "improving youth"),
         text = str_replace_all(text, "eemployment", "employment"),
         text = str_replace_all(text, "testedin", "tested in"),
         text = str_replace_all(text, "careeropportunities", "career opportunities"),
         text = str_replace_all(text, "technologyand", "technology and"),
         text = str_replace_all(text, "developmentsaffecting", "developments affecting"),
         text = str_replace_all(text, "givingsupport", "giving support"),
         text = str_replace_all(text, "sciencesmathematics", "sciences mathematics"),
         text = str_replace_all(text, "assistarice", "assistance"),
         text = str_replace_all(text, "iriception", "inception"),
         text = str_replace_all(text, "coricentrated", "concentrated"),
         text = str_replace_all(text, "coriception", "conception"),
         text = str_replace_all(text, "coricerned", "concerned"),
         text = str_replace_all(text, "sirice", "since"),
         text = str_replace_all(text, "coricentration", "concentration"),
         text = str_replace_all(text, "socialadvarice", "social advance"),
         text = str_replace_all(text, "comparativecommunity", "comparative community"),
         text = str_replace_all(text, "ministration", "administration"),
         text = str_replace_all(text, "appf priation", "appropriation"),
         text = str_replace_all(text, "appro priation", "appropriation"),
         text = str_replace_all(text, "priation", "appropriation"),
         text = str_replace_all(text, "internationalhealth", "international health"),
         text = str_replace_all(text, "publichealth", "public health"),
         text = str_replace_all(text, "interna tional", "international"),
         text = str_replace_all(text, "addi tional", "additional"),
         text = str_replace_all(text, "aroundadvarices", "around advances"),
         text = str_replace_all(text, "conferencewas", "conference was"),
         text = str_replace_all(text, "conferencewith", "conference with"),
         text = str_replace_all(text, "influenceof", "influence of"),
         text = str_replace_all(text, "evidencethat", "evidence that"),
         text = str_replace_all(text, "residenceproperty", "residence property"),
         text = str_replace_all(text, "\\bagricul tural", "agricultural"),
         text = str_replace_all(text, "\\bcul tural", "cultural"),
         text = str_replace_all(text, "culnj tural", "cultural"),
         text = str_replace_all(text, "struc tural", "structural"),
         text = str_replace_all(text, "struc ture", "structure"),
         text = str_replace_all(text, "organi zations", "organizations"),
         text = str_replace_all(text, "authorizationsunappropriated", 
                                "authorizations unappropriated"),
         text = str_replace_all(text, "societiesgeneral", "societies general"),
         text = str_replace_all(text, "terminationof", "termination of"),
         text = str_replace_all(text, "wasmade", "was made"),
         text = str_replace_all(text, "emergencyaid", "emergency aid"),
         text = str_replace_all(text, "tomeetapproappropriationspledgesand", 
                                "to meet appropriations pledges and"),
         text = str_replace_all(text, "followsbalarice", " follows balance"),
         text = str_replace_all(text, "termwas", "term was"),
         text = str_replace_all(text, "foundationprovides", "foundation provides"),
         text = str_replace_all(text, "generalbudget", "general budget"),
         text = str_replace_all(text, "givensince", "given since"),
         text = str_replace_all(text, "increasingproportion", "increasing proportion"),
         text = str_replace_all(text, "itfinnaly", "it finnaly"),
         text = str_replace_all(text, "assumedentire", "assumed entire"),
         text = str_replace_all(text, "termwas", "term was"),
         text = str_replace_all(text, "ofyellow", "of yellow"),
         text = str_replace_all(text, "studiesin", "studies in"),
         text = str_replace_all(text, "workthe", "work the"),
         text = str_replace_all(text, "programof", "program of"),
         text = str_replace_all(text, "effectivefor", "effective for"),
         text = str_replace_all(text, "intracontmental", "intracontinental"),
         text = str_replace_all(text, "intelli gence", "intelligence"),
         text = str_replace_all(text, "internalmedicine", "internal medicine"),
         text = str_replace_all(text, "forastudyoftheuseof", "for a study of the 
                                use of"),
         text = str_replace_all(text, "foundationinternational", "foundation international"),
         text = str_replace_all(text, "mankindthroughout", "mankind throughout"),
         text = str_replace_all(text, "havedemonstrated", "have demonstrated"),
         text = str_replace_all(text, "beendirected", "been directed"),
         text = str_replace_all(text, "todayand", "today and"),
         text = str_replace_all(text, "resiliencein", "resilience in"),
         text = str_replace_all(text, "environmentalproblems", "environmental problems"),
         text = str_replace_all(text, "foodgrainproduction", "food grain production"),
         text = str_replace_all(text, "malariaparasites", "malaria parasites"),
         text = str_replace_all(text, "activitieswhich", "activities which"),
         text = str_replace_all(text, "largescale", "large scale"),
         text = str_replace_all(text, "theinstitute", "the institute"),
         text = str_replace_all(text, "biologyand", "biology and"),
         text = str_replace_all(text, "taxexempt", "tax exempt"),
         text = str_replace_all(text, "economiesand", "economies and"),
         text = str_replace_all(text, "economicshocks", "economic shocks"),
         text = str_replace_all(text, "accompanyingstatements", "accompanying statements"),
         text = str_replace_all(text, "payableduring", "payable during"),
         text = str_replace_all(text, "agriculturalrsearch", "agricultural research"),
         text = str_replace_all(text, "trainingprogram", "training program"),
         text = str_replace_all(text, "foundationhave", "foundation have"),
         text = str_replace_all(text, "twoyear", "two year"),
         text = str_replace_all(text, "councilcommittee", "council committee"),
         text = str_replace_all(text, "afinalappropriation", "a final appropriation"),
         text = str_replace_all(text, "institutebiochemistry", "institute biochemistry"),
         text = str_replace_all(text, "threeyearperiod", "three year period"),
         text = str_replace_all(text, "completefinancialstatement", "complete financial statement"),
         text = str_replace_all(text, "foundationrepresents", "foundation represents"),
         text = str_replace_all(text, "tenyearperiod", "ten year period"),
         text = str_replace_all(text, "economichandicaps", "economic handicaps"),
         text = str_replace_all(text, "foreignlanguage", "foreign language"),
         text = str_replace_all(text, "appropriationsfor", "appropriations for"),
         text = str_replace_all(text, "carefullyselected", "carefully selected"),
         text = str_replace_all(text, "chinamedical", "china medical"),
         text = str_replace_all(text, "hokkaidouniversity", "hokkaido university"),
         text = str_replace_all(text, "nationalagricultural", "national agricultural"),
         text = str_replace_all(text, "likelyto", "likely to"),
         text = str_replace_all(text, "socialand", "social and"),
         text = str_replace_all(text, "mobilityregional", "mobility regional"),
         text = str_replace_all(text, "medicalscience", "medical science"),
         text = str_replace_all(text, "beendeveloped", "been developed"),
         text = str_replace_all(text, "includingthe", "including the"),
         text = str_replace_all(text, "andeducation", "and education"),
         text = str_replace_all(text, "advancementof", "advancement of"),
         text = str_replace_all(text, "appropriationsgrants", "appropriations grants"),
         text = str_replace_all(text, "applicantsthe", "applicants the"),
         text = str_replace_all(text, "sectorinnovation", "sector innovation"),
         text = str_replace_all(text, "organizationalbreakthroughs", "organizational breakthroughs"),
         text = str_replace_all(text, "localcommunities", "local communities"),
         text = str_replace_all(text, "coricentrates", "concentrates"),
         text = str_replace_all(text, "cerealresearch", "cereal research"),
         text = str_replace_all(text, "periodadriano", "period adriano"),
         text = str_replace_all(text, "threeyear", "three year"),
         text = str_replace_all(text, "shortterm", "short term"),
         text = str_replace_all(text, "closecooperation", "close cooperation"),
         text = str_replace_all(text, "artistinresidence", "artist in residence"),
         text = str_replace_all(text, "wellbeing(complexities|yet)", "wellbeing \\1"),
         text = str_replace_all(text, "welfare(budgets|in|philip|reform|related|to|work)", "welfare \\1"),
         text = str_replace_all(text, "(community|health|instituteofchild)welfare(recreation|rf)?", "\\1 welfare \\2"),
         text = str_replace_all(text, "instituteofchild", "institute of child"),
         text = str_replace_all(text, "fellowshipsandgrantinatdmpeipingunionmedicalcoilegerf", "fellowships and grant in aid in peiping union medical college"),
         text = str_replace_all(text, "thefieldof", "the field of"),
         text = str_replace_all(text, "paraly sis", "paralysis"),
         text = str_replace_all(text, "tuberculo sis", "tuberculosis"),
         text = str_replace_all(text, "mito sis", "mitosis"),
         text = str_replace_all(text, "morphogene sis", "morphogenesis"),
         text = str_replace_all(text, "empha sis", "emphasis"),
         text = str_replace_all(text, "synthe sis", "synthesis"),
         text = str_replace_all(text, "jniversity", "university"),
         text = str_replace_all(text, "jniversity", "university"),
         text = str_replace_all(text, "rcfkefeller", "rockefeller"),
         text = str_replace_all(text, "hworm", "hookworm"),
         text = str_replace_all(text, "\\bsch\\b", "school"),
         text = str_replace_all(text, "appointedfrom", "appointed from"),
         text = str_replace_all(text, "creativityculture", "creativity culture"),
         text = str_replace_all(text, "\\bcoss", "costs"),
         text = str_replace_all(text, "crosstheme", "cross-theme"),
         text = str_replace_all(text, "esearch", "research"),
         text = str_replace_all(text, "schoolistosomiasis", "schistosomiasis"),
         text = str_replace_all(text, "cerate", "coöperate"),
         text = str_replace_all(text, "sciencebased", "science-based"),
         text = str_replace_all(text, "appointedfrom", "appointed from"),
         text = str_replace_all(text, "annualreport", "annual-report"),
         text = str_replace_all(text, "\\bartis ans", "artisans"),
         text = str_replace_all(text, "\\bartis anal", "artisanal"),
         # text = str_replace_all(text, "\\bagricul", "agriculture"),
         text = str_replace_all(text, "\\bagron omy", "agronomy"),
         text = str_replace_all(text, "\\bagron\\b", "agronomy"),
         text = str_replace_all(text, "\\brresearch", "research"),
         text = str_replace_all(text, "boredhole", "bored-hole"),
         text = str_replace_all(text, "collegeof", "college of"),
         text = str_replace_all(text, "cciences", "sciences"),
         text = str_replace_all(text, "intellectualproperty", "intellectual-property"),
         text = str_replace_all(text, "technologytransfer", "technology transfer"),
         text = str_replace_all(text, "sciencebased", "science-based"),
         text = str_replace_all(text, "\\banal ysis", "analysis"),
         text = str_replace_all(text, "\\bana \\| ysis", "analysis"),
         text = str_replace_all(text, "\\bana ysis", "analysis"),
         text = str_replace_all(text, "\\bana lyze", "analyze"),
         text = str_replace_all(text, "centra", "centro"),
         text = str_replace_all(text, "childh", "childhood"),
         text = str_replace_all(text, "hong kong", "hong-kong"),
         text = str_replace_all(text, "\\bana lyze", "analyze"),
         text = str_replace_all(text, "prob lem(s?)", "problem"),
         text = str_replace_all(text, "prob ably", "probably"),
         text = str_replace_all(text, "cerating", "cooperating"),
         text = str_replace_all(text, "concentrotion", "concentration"),
         text = str_replace_all(text, "\\bnternational", "international"), 
         text = str_replace_all(text, "\\bnternationa", "international"),
         text = str_replace_all(text, "middleincome", "middle-income"),
         text = str_replace_all(text, "coriceptual", "conceptual"),
         text = str_replace_all(text, "fundingfor", "funding for"),
         text = str_replace_all(text, "partlclpatlon", "participation"),
         text = str_replace_all(text, "actlvlties", "activities"),
         text = str_replace_all(text, "instttute", "institute"),
         text = str_replace_all(text, "lts", "its"),
         text = str_replace_all(text, "bepobt", "report"),
         text = str_replace_all(text, "foundationnew", "foundation new"),
         text = str_replace_all(text, "carreldakin", "carrel-dakin"),
         text = str_replace_all(text, "cerative", "cooperative"),
         text = str_replace_all(text, "artistinresidence", "artist in residence"),
         text = str_replace_all(text, "andfor", "and for"),
         text = str_replace_all(text, "trainingfor", "training for"),
         text = str_replace_all(text, "distributionand", "distribution and"),
         text = str_replace_all(text, "communitybased", "community based"),
         text = str_replace_all(text, "programrelated", "program related"),
         text = str_replace_all(text, "climateconscious", "climate-conscious"),
         text = str_replace_all(text, "climaterelated", "climate-related"),
         text = str_replace_all(text, "nongovernmental", "non-governmental"),
         text = str_replace_all(text, "educatlon", "education"),
         text = str_replace_all(text, "materlals", "non-governmental"),
         text = str_replace_all(text, "chlldcare", "childcare"),
         text = str_replace_all(text, "afncan", "african"),
         text = str_replace_all(text, "socialservice", "social-service"),
         text = str_replace_all(text, "nonprofit", "non-profit"),
         text = str_replace_all(text, "theformation", "the formation"),
         text = str_replace_all(text, "towardthe", "toward the"),
         text = str_replace_all(text, "fiscalequitynew", "fiscal equity new"),
         text = str_replace_all(text, "annouriced", "announced"),
         text = str_replace_all(text, "\\bmem\\sber(s)?", "member\\1"),
         text = str_replace_all(text, "resuits", "results"),
         text = str_replace_all(text, "centrol", "central"))


## Cleaning and creating the data with punctuation ---- 
data.clean.punct <- Corpus  %>% 
  mutate(text = str_replace_all(text, "\\n", " "),
         text = str_remove_all(text, "[:punct:]"),
         text = str_remove_all(text, "[:digit:]"),
         text = str_remove_all(text, "_+"),
         text = str_remove_all(text, "(\\$|\\~|c~|\\^|\\£|\\^|<>|<|>|¯|>>|⇒|→|>oo|\\boo\\b|°|±|™|\\+|\\-|\\¥|\\■|\\|)\\w?"),
         text = tolower(text),
         text = str_replace_all(text, "wellbeing", "well-being"),
         text = str_remove_all(text,"\\bwe the rockefeller foundation\\b"),
         text = str_remove_all(text,"wwwrockfoundorg"),
         text = str_remove_all(text,"wwwrockefeller"),
         text = str_replace_all(text, "erice(s)?\\b", "ence\\1"),
         text = str_replace_all(text, "univer\\s*(.|usa)?\\s*sity", "university"),
         # text = str_replace_all(text, "zationseffort", "zations effort"),
         text = str_replace_all(text, "\\b(organi|moderni)\\s+(.|usa)?\\s+zation", "\\1zation"),
         # text = str_replace_all(text, "moderni zation", "modernization"),
         # text = str_replace_all(text, "organi zations", "organizations"),
         # text = str_replace_all(text, "organi usa zation", "organization"),
         text = str_replace_all(text, "appropria(\\s|\\t|\\n)+tions", "appropriations"),
         # text = str_replace_all(text, "appro[:space:]priations", "appropriations"),
         # text = str_replace_all(text, "appro\\n{1,5}priations", "appropriations"),
         text = str_replace_all(text, "\\b(ac|ag|aq)\\spriations", "\\1priations"), 
         # text = str_replace_all(text, "ag priations", "appropriations"), 
         # text = str_replace_all(text, "aq priations", "appropriations"), 
         text = str_remove_all(text, "\\brockefeller foundation\\b"),
         # text = str_replace_all(text, "paulodepart", "paulo depart"),
         # text = str_replace_all(text, "researchdepart", "research depart"),
         text = str_replace_all(text, "\\b(adjust|equip)\\s\\b[pjo]\\b", "\\1"),
         # text = str_replace_all(text, "equip p", "equip"),
         # text = str_replace_all(text, "equip j", "equip"),
         # text = str_replace_all(text, "equip o", "equip"),
         # text = str_replace_all(text, "depart o", "depart"),
         # text = str_replace_all(text, "depart j", "depart"),
         text = str_replace_all(text, "nonallgn", "non alligned"),
         text = str_replace_all(text, "(govern|depart|treat|equip|develop|require|move|impove|endow|employ|install|agree|establish|disburse|adjust|supple|experi|settle|pay|invest|ele|achieve|commit|appoint|docu|arrange|assign)\\sment", "\\1ment"),
         text = str_replace_all(text, "\\b([a-z]{1,12})\\s\\bment(s?)\\b", "\\1ment\\2"),
         text = str_replace_all(text, "devel\\sopment", "development"),
         text = str_replace_all(text, "de\\svelopment", "development"),
         text = str_replace_all(text, " depart\\sments", "departments"),
         # text = str_replace_all(text, "depart ment","department"), 
         # text = str_replace_all(text, "treat ments","treatments"),
         # text = str_replace_all(text, "equip ment","equipment"),
         # text = str_replace_all(text, "develop ment","development"),
         # text = str_replace_all(text, "require ment","requirement"),
         # text = str_replace_all(text, "move ment","movement"),
         # text = str_replace_all(text, "improve ment","improvement"),
         # text = str_replace_all(text, "endow ment","endowment"),
         # text = str_replace_all(text, "employ ment","employment"),
         # text = str_replace_all(text, "install ment","installment"),
         # text = str_replace_all(text, "agree ment","agreement"),
         # text = str_replace_all(text, "establish ment","establisment"),
         # text = str_replace_all(text, "disburse ment","disbursement"),
         # text = str_replace_all(text, "adjust ment","adjustment"),
         # text = str_replace_all(text, "supple ment","supplement"),
         # text = str_replace_all(text, "experi ment","experiment"),
         # text = str_replace_all(text, "settle ment","settlement"),
         # text = str_replace_all(text, "pay ment","payment"),
         # text = str_replace_all(text, "invest ment","investment"),
         # text = str_replace_all(text, "ele ment","element"),
         # text = str_replace_all(text, "achieve ment","achievement"),
         # text = str_replace_all(text, "commit ment","commitment"),
         # text = str_replace_all(text, "appoint ment","appointment"),
         # text = str_replace_all(text, "docu ment","document"),
         # text = str_replace_all(text, "arrange ment","arragement"),
         # text = str_replace_all(text, " assign ment","assignement"),
         text = str_replace_all(text, "\\b([a-z]{0,9})\\s\\bcation(s?)\\b", "\\1cation\\2"),
         text = str_replace_all(text, "telecommun", "telecommuni"),
         # text = str_replace_all(text, "education cation","education"),
         # text = str_replace_all(text, "communi cation","communication"),
         # text = str_replace_all(text, "appli cation","application"),
         # text = str_replace_all(text, "classifi cation","classification"),
         # text = str_replace_all(text, "publi cation","publication"),
         # text = str_replace_all(text, "telecommuni cation", "telecommunication"),
         # text = str_replace_all(text, "qualifi cation", "qualification"),
         # text = str_replace_all(text, "communi cation", "communication"),
         # text = str_replace_all(text, "emergedthe", "emerged the"),
         # text = str_replace_all(text, "worldpopu", "world popu"),
         text = str_replace_all(text, "\\b([a-z]{1,10})\\slation(s?)", "\\1lation\\2"),
         # text = str_replace_all(text, "popu lation", "population"),
         # text = str_replace_all(text, "overpopu lation", "overpopulation"),
         # text = str_replace_all(text, "trans lation", "translation"),
         # text = str_replace_all(text, "re lation", "relation"),
         # text = str_replace_all(text, "inocu lation", "inoculation"),
         # text = str_replace_all(text, "iso lation", "isolation"),
         # text = str_replace_all(text, "specu lation", "speculation"),
         text = str_replace_all(text, "foun\\sdation", "foundation"),
         text = str_replace_all(text, "accomo\\sdation", "accomodation"),
         text = str_replace_all(text, "comis\\sj", "comis"),
         text = str_replace_all(text, "([a-z]{2,9})\\ssion(s?)", "\\1ssion\\2"),
         # text = str_replace_all(text, "commis sion", "commission"),
         # text = str_replace_all(text, "promis sion", "promission"),
         # text = str_replace_all(text, "mis sion", "mission"),
         text = str_replace_all(text, "([a-z]{2,12})\\sion(s?)", "\\1sion\\2"),
         # text = str_replace_all(text, "comprehen sion", "comprehension"),
         # text = str_replace_all(text, "deci sion", "decision"),
         # text = str_replace_all(text, "divi sion", "division"),
         # text = str_replace_all(text, "profe sion", "profesion"),
         # text = str_replace_all(text, "man sion", "mansion"),
         # text = str_replace_all(text, "supervi sion", "supervision"),
         # text = str_replace_all(text, "provi sion", "provision"),
         # text = str_replace_all(text, "mis sions", "missions"),
         # text = str_replace_all(text, "pen sions", "pensions"),
         # text = str_replace_all(text, "exten sions", "extensions"),
         # text = str_replace_all(text, "discu sions", "discusions"),
         text = str_replace_all(text, "foun\\s(a|i)", "foun"),
         # text = str_replace_all(text, "foun i", "foun"),
         text = str_replace_all(text, "con\\struction", "construction"),
         # text = str_replace_all(text, "recon struction", "reconstruction"),
         text = str_replace_all(text, "oo struction", "construction"),
         text = str_replace_all(text, "indebted\\s(a|k)", "indebted"),
         # text = str_replace_all(text, "inthe", "in the"),
         # text = str_replace_all(text, "indebted a", "indebted"),
         # text = str_replace_all(text, "indebted k", "indebted"),
         text = str_replace_all(text, "([a-z]{0,11})\\s\\bness(e?s?)\\b", "\\1ness\\2"), 
         text = str_replace_all(text, "feebleminded ness", "feeblemindedness"),
         # text = str_replace_all(text, "andinterrelated", "and interrelated"),
         # text = str_replace_all(text, "readi ness", "readiness"),
         # text = str_replace_all(text, "dizi ness", "diziness"),
         # text = str_replace_all(text, "blind ness", "blindness"),
         # text = str_replace_all(text, "sick ness", "sickness"),
         # text = str_replace_all(text, "busi ness", "business"),
         # text = str_replace_all(text, "sensitive ness", "sensitiveness"),
         # text = str_replace_all(text, "indebted ness", "indebtedness"),
         # text = str_replace_all(text, "feebleminded ness", "feeblemindedness"),
         # text = str_replace_all(text, "effective ness", "effectiveness"),
         # text = str_replace_all(text, "poor ness", "poorness"),
         # text = str_replace_all(text, "interrelated ness", "interrelatedness"),
         # text = str_replace_all(text, "care ness", "careness"),
         # text = str_replace_all(text, "aware ness", "awareness"),
         # text = str_replace_all(text, "weak nesses", "weaknesses"),
         # text = str_replace_all(text, "internship nesses", "internshipnesses"),
         text = str_replace_all(text, "\\bcom\\sq", "com"),
         text = str_replace_all(text, "\\bcom\\smunit(y|ies)", "communit\\1"),
         # text = str_replace_all(text, "com munity", "community"),
         # text = str_replace_all(text, "com munities", "communities"),
         text = str_replace_all(text, "im\\smunity", "immunity"),
         text = str_replace_all(text, "corpo\\s~", "corpo"),
         
         text = str_replace_all(text, "\\b([a-z]{0,9})\\s\\bration(s?)\\b", "\\1ration\\2"), 
         # text = str_replace_all(text, "corpo ration", "corporation"),
         # text = str_replace_all(text, "prepa ration", "preparation"),
         # text = str_replace_all(text, "explo ration", "exploration"),
         text = str_replace_all(text, "\\badminis\\s>\\sj", "adminis"),
         
         text = str_replace_all(text, "\\b([a-z]{2,9})\\s\\btration(s?)\\b", "\\1tration\\2"),
         # text = str_replace_all(text, "adminis tration", "administration"),
         # text = str_replace_all(text, "concen tration", "concentration"),
         # text = str_replace_all(text, "concen trations", "concentrations"),
         # text = str_replace_all(text, "regis tration", "registration"),
         
         text = str_replace_all(text, "([a-z]{2,10})\\s\\btional(s?)\\b", "\\1tional\\2"),
         # text = str_replace_all(text, "interna tional", "international"),
         # text = str_replace_all(text, "addi tional", "additional"),
         text = str_replace_all(text, "\\b([a-z]{2,10})\\s\\btural(s?)\\b", "\\1tural\\2"),
         # text = str_replace_all(text, "agricul tural", "agricultural"),
         # text = str_replace_all(text, "cul tural", "cultural"),
         # text = str_replace_all(text, "culnj tural", "cultural"),
         # text = str_replace_all(text, "struc tural", "structural"),
         text = str_replace_all(text, "\\b([a-z]{1,11})\\s\\bation(s?)\\b", "\\1ation\\2"),
         # text = str_replace_all(text, "situ ation", "situation"),
         # text = str_replace_all(text, "consider ation", "consideration"),
         # text = str_replace_all(text, "consider ations", "considerations"),
         # text = str_replace_all(text, "appropi ation", "appropriation"),
         # text = str_replace_all(text, "demobiliz ation", "demobilization"),
         # text = str_replace_all(text, "associ ation", "association"),
         # text = str_replace_all(text, "found ation", "foundation"),
         # text = str_replace_all(text, "cooper ation", "cooperation"),
         # text = str_replace_all(text, "programm ation", "programmation"),
         # text = str_replace_all(text, "oper ation", "operation"),
         # text = str_replace_all(text, "oper ations", "operations"),
         # text = str_replace_all(text, "radi ation", "radiation"),
         # text = str_replace_all(text, "cre ation", "creaation"),
         # text = str_replace_all(text, "tax ation", "taxation"),
         # text = str_replace_all(text, "feder ation", "federation"),
         # text = str_replace_all(text, "fund ations", "fundations"),
         
         text = str_replace_all(text, "\\b([a-z]{1,10})\\s\\btation(s?)\\b", "\\1tation\\2"),
         # text = str_replace_all(text, "limi tation", "limitation"),
         # text = str_replace_all(text, "sani tation", "sanitation"),
         # text = str_replace_all(text, "vege tation", "vegetation"),
         # text = str_replace_all(text, "infes tation", "infestation"),
         # text = str_replace_all(text, "documen tation", "documentation"),
         # text = str_replace_all(text, "compu tation", "computation"),
         # text = str_replace_all(text, "compu tations", "computations"),
         # text = str_replace_all(text, "transpor tation", "transportation"),
         # text = str_replace_all(text, "interpre tation", "interpretation"),
         # text = str_replace_all(text, "rehabili tation", "rehabilitation"),
         text = str_replace_all(text, "\\b([a-z]{2,12})\\s\\btion(s?)\\b", "\\1tion\\2"),
         # text = str_replace_all(text, "investiga tion", "investigation"),
         # text = str_replace_all(text, "investiga tions", "investigations"),
         
         text = str_replace_all(text, "\\b([a-z]{1,13})\\s\\bit(y|ies)\\b", "\\1it\\2"),
         # text = str_replace_all(text, "captiv ity", "captivity"),
         # text = str_replace_all(text, "qual ity", "quality"),
         # text = str_replace_all(text, "activ ity", "activity"),
         # text = str_replace_all(text, "commun ity", "community"),
         # text = str_replace_all(text, "calam ity", "calamity"),
         # text = str_replace_all(text, "hered ity", "heredity"),
         # text = str_replace_all(text, "produc ity", "productvity"),
         # text = str_replace_all(text, "valid ity", "validity"),
         # text = str_replace_all(text, "qual ity", "quality"),
         # text = str_replace_all(text, "valid ity", "validity"),
         # text = str_replace_all(text, "objectiv ity", "objectivity"),
         # text = str_replace_all(text, "fertil ity", "fertility"),
         # text = str_replace_all(text, "facil ity", "facility"),
         # text = str_replace_all(text, "insular ity", "insularity"),
         # text = str_replace_all(text, "univers ity", "university"),
         # text = str_replace_all(text, "environmental ity", "environmentality"),
         
         text = str_replace_all(text, "([a-z]{1,12})\\s\\bence(s?)\\b", "\\1ence\\2"),
         # text = str_replace_all(text, "sci ence", "science"),
         # text = str_replace_all(text, "influ ence", "influence"),
         # text = str_replace_all(text, "confe rence", "conference"),
         # text = str_replace_all(text, "refer ence", "reference"),
         # text = str_replace_all(text, "independ ence", "independence"),
         # text = str_replace_all(text, "refer ence", "reference"),
         
         text = str_replace_all(text, "\\b([a-z]{2,11})\\s\\btive(s?)\\b", "\\1tive\\2"),
         
         text = str_replace_all(text, "attenu ated", "attenuated"),
         text = str_replace_all(text, "\\boper ated", "operated"),
         text = str_replace_all(text, "appropri ated", "appropriated"),
         text = str_replace_all(text, "initi ated", "initiated"),
         text = str_replace_all(text, "evalu ated", "evaluated"),
         text = str_replace_all(text, "cre ated", "created"),
         text = str_replace_all(text, "associ ated", "associated"),
         text = str_replace_all(text, "situ ated", "situated"),
         text = str_replace_all(text, "affili oo ated", "affiliated"),
         text = str_replace_all(text, "cooper ated", "cooperated"),
         text = str_replace_all(text, "unaffili", "unaffiliated"),
         text = str_replace_all(text, "exagger ated", "exaggerated"),
         
         text = str_replace_all(text, "jniver ~", "univers"),
         text = str_replace_all(text, "ca lamities", "calamities"),
         text = str_replace_all(text, "accaountantfacil", "accaountant facil "),
         text = str_replace_all(text, "popu atlon", "population"),
         text = str_replace_all(text, "expendi tures", "expenditures"),
         text = str_replace_all(text, "corpoi", "corpor"),
         text = str_replace_all(text, "oper >", "oper"),
         text = str_replace_all(text, "collaboi", "collabor"),
         text = str_replace_all(text, "pos sible", "possible"),
         text = str_replace_all(text, "ap propri", "appropri"),
         text = str_replace_all(text, "populationappropri", "population appropri"),
         text = str_replace_all(text, "admin istration", "administration"),
         text = str_replace_all(text, "expendi ", "expenditures"),
         text = str_replace_all(text, "cd room", "cd-room"),
         text = str_replace_all(text, "nce", "rice"),
         text = str_replace_all(text, "viricent", "vincent"),
         text = str_replace_all(text, "organizuion", "organization"),
         text = str_replace_all(text, "autnoma", "autonoma"),
         text = str_replace_all(text, "ommunities", "communities"),
         text = str_replace_all(text, "ommunity", "community"),
         text = str_replace_all(text, "insurarice", "insurance"),
         text = str_replace_all(text, "ommunities", "communities"),
         text = str_replace_all(text, "californiaa", "california"),
         text = str_replace_all(text, "cccommunity", "community"),
         text = str_replace_all(text, "ccommunity", "community"),
         text = str_replace_all(text, "cccommunities", "communities"),
         text = str_replace_all(text, "ccommunities", "communities"),
         text = str_replace_all(text, "certifi cates", "certificates"),
         text = str_replace_all(text, "cer tificates", "certificates"),
         
         text = str_replace_all(text, "theadvancement", "the advancement"),
         text = str_replace_all(text, "thedevelopment", "the development"),
         text = str_replace_all(text, "thedivision", "the division"),
         text = str_replace_all(text, "thedirection", "the direction"),
         text = str_replace_all(text, "thegovernment", "the government"),
         text = str_replace_all(text, "thecommission", "the commission"), 
         text = str_replace_all(text, "theestablishment", "the establishment"),
         text = str_replace_all(text, "thepopulation", "the population"),
         text = str_replace_all(text, "theimprovement", "the improvement"),
         text = str_replace_all(text, "thereproduction", "the reproduction"),
         text = str_replace_all(text, "theassociation", "the association"),
         text = str_replace_all(text, "thetreatment", "the treatment"), 
         text = str_replace_all(text, "thepreparation", "the preparation"),
         text = str_replace_all(text, "theadvancement", "the advancement"),
         text = str_replace_all(text, "theorganization", "the organization"),
         text = str_replace_all(text, "thecorporation", "the corporation"),
         text = str_replace_all(text, "thedistribution", "the distribution"),
         text = str_replace_all(text, "theintroduction", "the introduction"), 
         text = str_replace_all(text, "thecreation", "the creation"),
         text = str_replace_all(text, "thecooperation", "the cooperation"),
         text = str_replace_all(text, "theinfection", "the infection"),
         text = str_replace_all(text, "theconstruction", "the construction"),
         text = str_replace_all(text, "theapplication", "the application"),
         text = str_replace_all(text, "thesolution", "the solution"),
         text = str_replace_all(text, "theinvestigation", "the investigation"),
         text = str_replace_all(text, "thecompletion", "the completion"),
         text = str_replace_all(text, "thestation", "the station"),
         text = str_replace_all(text, "thepromotion", "the promotion"),
         text = str_replace_all(text, "theuniversity", "the university"),
         text = str_replace_all(text, "thefoundation", "the foundation"),
         text = str_replace_all(text, "thedepartment", "the department"),
         text = str_replace_all(text, "thefoundations", "the foundations"),
         text = str_replace_all(text, "thehumanities", "the humanities"),
         text = str_replace_all(text, "thecity", "the city"),
         text = str_replace_all(text, "theappropriations", "the appropriations"),
         text = str_replace_all(text, "therockefeller", "the rockefeller"),
         text = str_replace_all(text, "theeditors", "the editors"),
         text = str_replace_all(text, "thegrants", "the grants"),
         text = str_replace_all(text, "theblood", "the blood"),
         text = str_replace_all(text, "thecommittee", "the committee"),
         text = str_replace_all(text, "thebureau", "the bureau"),
         text = str_replace_all(text, "theimportant", "the important"),
         text = str_replace_all(text, "theressources", "the ressources"),
         text = str_replace_all(text, "witheressources", "the ressources"),
         text = str_replace_all(text, "theinternational", "the international"),
         text = str_replace_all(text, "thepractice", "the practice"),
         text = str_replace_all(text, "theproject", "the project"),
         text = str_replace_all(text, "theworld", "the world"),
         text = str_replace_all(text, "theinternal", "the internal"),
         text = str_replace_all(text, "thecouncil", "the council"),
         text = str_replace_all(text, "theeconomic", "the economic"),
         text = str_replace_all(text, "thenational", "the national"),
         text = str_replace_all(text, "themedical", "the medical"),
         text = str_replace_all(text, "thework", "the work"),
         text = str_replace_all(text, "thesocial", "the social"),
         text = str_replace_all(text, "thecalifornia", "the california"),
         text = str_replace_all(text, "thestate", "the state"),
         text = str_replace_all(text, "theothers", "the others"),
         
         text = str_replace_all(text, "andequipment", "and equipment"),
         text = str_replace_all(text, "andtreatment", "and treatment"),
         text = str_replace_all(text, "andgovernment", "and government"),
         text = str_replace_all(text, "anddistribution", "and distribution"),
         text = str_replace_all(text, "andfixedequipment", "and fixed equipement"),
         text = str_replace_all(text, "anddevelopment", "and development"),
         text = str_replace_all(text, "andalso", "and also"),
         text = str_replace_all(text, "andcommodities", "and commodities"),
         text = str_replace_all(text, "andeconomic", "and economic"),
         text = str_replace_all(text, "andwomen", "and women"),
         text = str_replace_all(text, "andrelationships", "and relationships"),
         text = str_replace_all(text, "andscientists", "and scientists"),
         text = str_replace_all(text, "andpossibilities", "and possibilities"),
         text = str_replace_all(text, "andexpanded", "and expanded"),
         text = str_replace_all(text, "andaccordingly", "and accordingly"),
         text = str_replace_all(text, "ofinfection", "of infection"),
         text = str_replace_all(text, "ofdevelopment", "of development"),
         text = str_replace_all(text, "offoundation", "of foundation"),
         text = str_replace_all(text, "ofpopulation", "of population"),
         text = str_replace_all(text, "ofequipment", "of equipment"),
         text = str_replace_all(text, "oftreatment", "of treatment"),
         text = str_replace_all(text, "ofnutrition", "of nutrition"),
         text = str_replace_all(text, "ofinvestigations", "of investigations"),
         text = str_replace_all(text, "ofinformation", "of informtion"),
         text = str_replace_all(text, "ofrecognized", "of recognised"),
         text = str_replace_all(text, "ofmedical", "of medical"),
         text = str_replace_all(text, "ofeducation", "of education"),
         text = str_replace_all(text, "ofminorityyouth", "of minority youth"),
         text = str_replace_all(text, "ofhealth", "of health"),
         text = str_replace_all(text, "ofdistinguished", "of distinguished"),
         text = str_replace_all(text, "ofsanitary", "of sanitary"),
         text = str_replace_all(text, "ofresearch", "of research"),
         text = str_replace_all(text, "overthe", "over the"),
         text = str_replace_all(text, "withtheressources", "with the ressources"),
         text = str_replace_all(text, "withmore", "with more"),
         text = str_replace_all(text, "withfoundation", "with foundation"),
         text = str_replace_all(text, "toaccomplish", "to accomplish"),
         text = str_replace_all(text, "tooperate", "to operate"),
         text = str_replace_all(text, "toinequality", "to inequality"),
         text = str_replace_all(text, "toincrease", "to increase"),
         text = str_replace_all(text, "tothe", "to the"),
         text = str_replace_all(text, "toassist", "to assist"),
         text = str_replace_all(text, "aneducation", "an education"),
         text = str_replace_all(text, "anappropriation", "an appropriation"),
         text = str_replace_all(text, "theparticipating", "the participating"),
         text = str_replace_all(text, "afoundation", "a foundation"),
         text = str_replace_all(text, "asingle", "a single"),
         text = str_replace_all(text, "whetherthey", "wether they"),
         text = str_replace_all(text, "foodproduction", "food production"),
         text = str_replace_all(text, "incollaboration", "in collaboration"),
         text = str_replace_all(text, "incooperation", "in cooperation"), 
         text = str_replace_all(text, "inaddition", "in addition"),
         text = str_replace_all(text, "infieldof", "in field of"),
         text = str_replace_all(text, "fordevelopment", "for development"),
         text = str_replace_all(text, "forcollaborative", "for collaborative"),
         text = str_replace_all(text, "foruse", "for use"),
         text = str_replace_all(text, "forthe", "for the"),
         text = str_replace_all(text, "healthdivision", "health division"),
         text = str_replace_all(text, "healthorganization" , "health organization"),
         text = str_replace_all(text, "healthdepartment", "health department"),
         text = str_replace_all(text, "healtheducation", "health education"),
         text = str_replace_all(text, "healthadministration", "health administration"),
         text = str_replace_all(text, "healthcommission", "health commission"),
         text = str_replace_all(text, "highereducation", "higher education"),
         text = str_replace_all(text, "medicaleducation", "medical education"),
         text = str_replace_all(text, "publicadministration", "public administration"),
         text = str_replace_all(text, "foundationfoundation", "foundation"),
         text = str_replace_all(text, "foundationtable", "foundation table"),
         text = str_replace_all(text, "foundationcontents", "foundation contents"),
         text = str_replace_all(text, "foundationgrants", "foundation grants"),
         text = str_replace_all(text, "foundationuniversity", "foundation university"),
         text = str_replace_all(text, "foundationscience", "foundation science"),
         text = str_replace_all(text, "foundationintroductionthe", "foundation
                                introduction the"),
         text = str_replace_all(text, "foundationsystematically", "foundation systematically"),
         text = str_replace_all(text, "foundationsupported", "foundation supported"),
         text = str_replace_all(text, "foundationgrant", "foundation grant"),
         text = str_replace_all(text, "foundationabout", "foundation about"),
         text = str_replace_all(text, "foundationin", "foundation in"),
         text = str_replace_all(text, "foundationadministered", "foundation administered"),
         text = str_replace_all(text, "foundationtion", "foundation"),
         text = str_replace_all(text, "foundationphotograph", "foundation photograph"),
         text = str_replace_all(text, "foundationon", "foundation on"),
         text = str_replace_all(text, "foundationbalarice", "foundation balance"),
         text = str_replace_all(text, "foundationopportunities", "foundation opportunities"),
         text = str_replace_all(text, "soilpollution", "soil pollution"),
         text = str_replace_all(text, "soilshokkaido", "soils hokkaido"),
         text = str_replace_all(text, "wuniversity", "university"),
         text = str_replace_all(text, "universitythe", "university the"),
         text = str_replace_all(text, "univesitythe", "university the"),
         text = str_replace_all(text, "umversidad", "universidad"),
         text = str_replace_all(text, "communitydevelopment", "community development"),
         text = str_replace_all(text, "hookworminfection", "hookworm infection"),
         text = str_replace_all(text, "economicdevelopment", "economic development"),
         text = str_replace_all(text, "reportfoundation", "report foundation"),
         text = str_replace_all(text, "nursingeducation", "nursing education"),
         text = str_replace_all(text, "educationagriculture", "education agriculture"),
         text = str_replace_all(text, "specialattention", "special attention"),
         text = str_replace_all(text, "sciencenutrition", "science nutrition"),
         text = str_replace_all(text, "ruralreconstruction", "rural reconstruction"),
         text = str_replace_all(text, "complementfixation", "complement fixation"), 
         text = str_replace_all(text, "saltflotation", "salt flotation"),
         text = str_replace_all(text, "rockfellerfoundation", "rockfeller foundation"),
         text = str_replace_all(text, "perioduniversity", "period university"),
         text = str_replace_all(text, "grantsuniversity", "grants university"),
         text = str_replace_all(text, "internationalrelations", "international relations"), 
         text = str_replace_all(text, "guniversity", "university"),
         text = str_replace_all(text, "columbiauniversity", "columbia university"),
         text = str_replace_all(text, "hssuniversity", "hss university"),
         text = str_replace_all(text, "paymentsuniversities", "payments universities"),
         text = str_replace_all(text, "forfiveyears", "for five years"),
         text = str_replace_all(text, "highyielding", "high yielding"),
         text = str_replace_all(text, "highquality", "high quality"),
         text = str_replace_all(text, "arthropodborne", "arthropod-borne"),
         text = str_replace_all(text, "nee", "rice"),
         text = str_replace_all(text, "hivaids", "hiv aids"),
         text = str_replace_all(text, "tne", "the"),
         text = str_replace_all(text, "latrines", "latrine"),
         text = str_replace_all(text, "otherexhibition", "other exhibition"),
         text = str_replace_all(text, "rockefellerfoundation", "rockefeller foundation"),
         text = str_replace_all(text, "harvarduniversity", "harvard university"),
         text = str_replace_all(text, "aboveuniversity", "above university"),
         text = str_replace_all(text, "generaleducation", "general education"),
         text = str_replace_all(text, "nonproliferation", "non-proliferation"),
         text = str_replace_all(text, "periodunivkhsity", "period university"),
         text = str_replace_all(text, "varietiestanzania", "varieties tanzania"),
         text = str_replace_all(text, "policieshuman", "policies human"),
         text = str_replace_all(text, "salaamtanzania", "salaam tanzania"),
         text = str_replace_all(text, "salaamfrom", "salaam from"),
         text = str_replace_all(text, "ascomprehensive", "as comprehensive"),
         text = str_replace_all(text, "characterizationbiotechnologyscnpps", 
                                "characterization biotechnology scnpps"),
         text = str_replace_all(text, "associatepatricia", "associate patricia"),
         text = str_replace_all(text, "associatejohn", "associate john"),
         text = str_replace_all(text, "biologyjudge", "biology judge"),
         text = str_replace_all(text, "minoritygroup", "minority group"),
         text = str_replace_all(text, "europeanracial", "european racial"),
         text = str_replace_all(text, "mexicanamerican", "mexican american"),
         text = str_replace_all(text, "peruuniversity", "peru university"),
         text = str_replace_all(text, "japanhokkaido", "japan hokkaido"),
         text = str_replace_all(text, "japangraduate", "japan graduate"),
         text = str_replace_all(text, "japanhague", "japan hague"),
         text = str_replace_all(text, "japaneseunited", "japanese united"),
         text = str_replace_all(text, "colombiauniversity", "colombia university"),
         text = str_replace_all(text, "colombiaversity", "colombia university"),
         text = str_replace_all(text, "brazillaboratory", "brazil laboratory"),
         text = str_replace_all(text, "availableto", "available to"),
         text = str_replace_all(text, "fourfellowships", "four fellowships"),
         text = str_replace_all(text, "valuespririceton", "values princenton"),
         text = str_replace_all(text, "medicineuniversity", "medicine university"),
         text = str_replace_all(text, "facultyof", "faculty of"),
         text = str_replace_all(text, "veterinarymedicine", "veterinary medicine"),
         text = str_replace_all(text, "biologygenetics", "biologoy genetics"),
         text = str_replace_all(text, "developmentsustainable", "development sustainable"),
         text = str_replace_all(text, "projectsupport", "project support"),
         text = str_replace_all(text, "autnoma", "autonoma"),
         text = str_replace_all(text, "darice", "dance"),
         text = str_replace_all(text, "entrarice", "entrance"),
         text = str_replace_all(text, "substarices", "substances"),
         text = str_replace_all(text, "importarice", "importance"),
         text = str_replace_all(text, "coricentrating", "concentrating"),
         text = str_replace_all(text, "periodjapanhokkaido", "period japan hokkaido"),
         text = str_replace_all(text, "sociologydemography", "sociology demography"),
         text = str_replace_all(text, "laboratoryteaching", "laboratory teaching"),
         text = str_replace_all(text, "httpwwwhindustantimescomnewsfeedindiaindiacheersasmonsoonarriveshopesofbetterfarmoutputraisedarticleaspx", 
                                "http www hindustan times com news feed india india cheersas monsoon arrives hopes of better farm out put raised article aspx"),
         text = str_replace_all(text, "resiliericestrategies", "resilience strategies"),
         text = str_replace_all(text, "broadlyshared", "broadly shared"),
         text = str_replace_all(text, "changewhile", "change while"),
         text = str_replace_all(text, "insurariceproducts", "insurance products"),
         text = str_replace_all(text, "themworldand", "them world an"),
         text = str_replace_all(text, "smallholder", "small holder"),
         text = str_replace_all(text, "climatechange", "climate change"),
         text = str_replace_all(text, "activitiesexhibition", "activities exhibition"),
         text = str_replace_all(text, "testimonyvernacular", "testimony vernacular"),
         text = str_replace_all(text, "collaborationand", "collaboration and"),
         text = str_replace_all(text, "providechroreographic", "provide choreographic"),
         text = str_replace_all(text, "anyonesexpextation", "anyones expectation"),
         text = str_replace_all(text, "specialscholarships", "special scholarships"),
         text = str_replace_all(text, "scholarshipassistarice", "scholarship assistance"),
         text = str_replace_all(text, "automaticdrips", "automatic drips"),
         text = str_replace_all(text, "studiesand", "studies and"),
         text = str_replace_all(text, "trainingbases", "training bases"),
         text = str_replace_all(text, "bloodforming", "blood forming"),
         text = str_replace_all(text, "basicbiological", "basic biological"),
         text = str_replace_all(text, "pathologicalthrough", "pathological through"),
         text = str_replace_all(text, "substariceswhich", "substances which"),
         text = str_replace_all(text, "arrangementshave", "arrangement shave"),
         text = str_replace_all(text, "statesintensive", "states intensive"),
         text = str_replace_all(text, "whichhave", "which have"), 
         text = str_replace_all(text, "southernstates", "southern states"), 
         text = str_replace_all(text, "morethat", "more that"),
         text = str_replace_all(text, "theirresponsibility", "their responsibility"),
         text = str_replace_all(text, "degreeof", "degree of"),
         text = str_replace_all(text, "entirerepublic", "entire republic"),
         text = str_replace_all(text, "effectivemethods", "effective methods"),
         text = str_replace_all(text, "averagedegree", "average degree"),
         text = str_replace_all(text, "governmentprivate", "government private"),
         text = str_replace_all(text, "betterqualified", "better qualified"),
         text = str_replace_all(text, "residualspraying", "residual spraying"),
         text = str_replace_all(text, "tworepresentative", "two representative"),
         text = str_replace_all(text, "worldwideusefulness", "worldwide usefullness"),
         text = str_replace_all(text, "favorabletime", "favorable time"),
         text = str_replace_all(text, "methodthe", "method the"),
         text = str_replace_all(text, "authoritieshowever", "authorities however"),
         text = str_replace_all(text, "decreasein", "decrease in"),
         text = str_replace_all(text, "morelimited", "more limited"),
         text = str_replace_all(text, "whichhas", "which has"),
         text = str_replace_all(text, "isan", "is an"),
         text = str_replace_all(text, "truethat", "true that"),
         text = str_replace_all(text, "decadebecomes", "decade becomes"),
         text = str_replace_all(text, "socialsanitary", "social sanitary"),
         text = str_replace_all(text, "theirdistribution", "their distribution"),
         text = str_replace_all(text, "housingfamily", "housing family"),
         text = str_replace_all(text, "problemswhich", "problems which"),
         text = str_replace_all(text, "byfor", "by for"),
         text = str_replace_all(text, "feasabilitypower", "feasability power"),
         text = str_replace_all(text, "prospectthought", "prospect thought"),
         text = str_replace_all(text, "inprogress", "in progress"),
         text = str_replace_all(text, "selfsufficiency", "self sufficiency"),
         text = str_replace_all(text, "providessupport", "provides support"),
         text = str_replace_all(text, "agegroups", "age groups"),
         text = str_replace_all(text, "proposedpersonal", "proposed personal"),
         text = str_replace_all(text, "scholarsphilanthropic", "scholars philanthropic"),
         text = str_replace_all(text, "noeconomic", "no economic"),
         text = str_replace_all(text, "journalismeducationberkeley", 
                                "journalism education berkeley"),
         text = str_replace_all(text, "towardsits", "towards its"),
         text = str_replace_all(text, "numberof", "number of"),
         text = str_replace_all(text, "newspaperindustry", "newspaper industry economic"),
         text = str_replace_all(text, "robinsonfoundationnew", 
                                "robinson foundation new"),
         text = str_replace_all(text, "fundadevelopment", "fund a development"),
         text = str_replace_all(text, "citizensexpanding", "citizens expanding"),
         text = str_replace_all(text, "businesscollaboratweprogramsaimedat", 
                                "business collaborat we programs aimed at"),
         text = str_replace_all(text, "improvingyouth", "improving youth"),
         text = str_replace_all(text, "eemployment", "employment"),
         text = str_replace_all(text, "testedin", "tested in"),
         text = str_replace_all(text, "careeropportunities", "career opportunities"),
         text = str_replace_all(text, "technologyand", "technology and"),
         text = str_replace_all(text, "developmentsaffecting", "developments affecting"),
         text = str_replace_all(text, "givingsupport", "giving support"),
         text = str_replace_all(text, "sciencesmathematics", "sciences mathematics"),
         text = str_replace_all(text, "assistarice", "assistance"),
         text = str_replace_all(text, "iriception", "inception"),
         text = str_replace_all(text, "coricentrated", "concentrated"),
         text = str_replace_all(text, "coriception", "conception"),
         text = str_replace_all(text, "coricerned", "concerned"),
         text = str_replace_all(text, "sirice", "since"),
         text = str_replace_all(text, "coricentration", "concentration"),
         text = str_replace_all(text, "socialadvarice", "social advance"),
         text = str_replace_all(text, "comparativecommunity", "comparative community"),
         text = str_replace_all(text, "ministration", "administration"),
         text = str_replace_all(text, "appf priation", "appropriation"),
         text = str_replace_all(text, "appro priation", "appropriation"),
         text = str_replace_all(text, "priation", "appropriation"),
         text = str_replace_all(text, "internationalhealth", "international health"),
         text = str_replace_all(text, "publichealth", "public health"),
         text = str_replace_all(text, "interna tional", "international"),
         text = str_replace_all(text, "addi tional", "additional"),
         text = str_replace_all(text, "aroundadvarices", "around advances"),
         text = str_replace_all(text, "conferencewas", "conference was"),
         text = str_replace_all(text, "conferencewith", "conference with"),
         text = str_replace_all(text, "influenceof", "influence of"),
         text = str_replace_all(text, "evidencethat", "evidence that"),
         text = str_replace_all(text, "residenceproperty", "residence property"),
         text = str_replace_all(text, "\\bagricul tural", "agricultural"),
         text = str_replace_all(text, "\\bcul tural", "cultural"),
         text = str_replace_all(text, "culnj tural", "cultural"),
         text = str_replace_all(text, "struc tural", "structural"),
         text = str_replace_all(text, "struc ture", "structure"),
         text = str_replace_all(text, "organi zations", "organizations"),
         text = str_replace_all(text, "authorizationsunappropriated", 
                                "authorizations unappropriated"),
         text = str_replace_all(text, "societiesgeneral", "societies general"),
         text = str_replace_all(text, "terminationof", "termination of"),
         text = str_replace_all(text, "wasmade", "was made"),
         text = str_replace_all(text, "emergencyaid", "emergency aid"),
         text = str_replace_all(text, "tomeetapproappropriationspledgesand", 
                                "to meet appropriations pledges and"),
         text = str_replace_all(text, "followsbalarice", " follows balance"),
         text = str_replace_all(text, "termwas", "term was"),
         text = str_replace_all(text, "foundationprovides", "foundation provides"),
         text = str_replace_all(text, "generalbudget", "general budget"),
         text = str_replace_all(text, "givensince", "given since"),
         text = str_replace_all(text, "increasingproportion", "increasing proportion"),
         text = str_replace_all(text, "itfinnaly", "it finnaly"),
         text = str_replace_all(text, "assumedentire", "assumed entire"),
         text = str_replace_all(text, "termwas", "term was"),
         text = str_replace_all(text, "ofyellow", "of yellow"),
         text = str_replace_all(text, "studiesin", "studies in"),
         text = str_replace_all(text, "workthe", "work the"),
         text = str_replace_all(text, "programof", "program of"),
         text = str_replace_all(text, "effectivefor", "effective for"),
         text = str_replace_all(text, "intracontmental", "intracontinental"),
         text = str_replace_all(text, "intelli gence", "intelligence"),
         text = str_replace_all(text, "internalmedicine", "internal medicine"),
         text = str_replace_all(text, "forastudyoftheuseof", "for a study of the 
                                use of"),
         text = str_replace_all(text, "foundationinternational", "foundation international"),
         text = str_replace_all(text, "mankindthroughout", "mankind throughout"),
         text = str_replace_all(text, "havedemonstrated", "have demonstrated"),
         text = str_replace_all(text, "beendirected", "been directed"),
         text = str_replace_all(text, "todayand", "today and"),
         text = str_replace_all(text, "resiliencein", "resilience in"),
         text = str_replace_all(text, "environmentalproblems", "environmental problems"),
         text = str_replace_all(text, "foodgrainproduction", "food grain production"),
         text = str_replace_all(text, "malariaparasites", "malaria parasites"),
         text = str_replace_all(text, "activitieswhich", "activities which"),
         text = str_replace_all(text, "largescale", "large scale"),
         text = str_replace_all(text, "theinstitute", "the institute"),
         text = str_replace_all(text, "biologyand", "biology and"),
         text = str_replace_all(text, "taxexempt", "tax exempt"),
         text = str_replace_all(text, "economiesand", "economies and"),
         text = str_replace_all(text, "economicshocks", "economic shocks"),
         text = str_replace_all(text, "accompanyingstatements", "accompanying statements"),
         text = str_replace_all(text, "payableduring", "payable during"),
         text = str_replace_all(text, "agriculturalrsearch", "agricultural research"),
         text = str_replace_all(text, "trainingprogram", "training program"),
         text = str_replace_all(text, "foundationhave", "foundation have"),
         text = str_replace_all(text, "twoyear", "two year"),
         text = str_replace_all(text, "councilcommittee", "council committee"),
         text = str_replace_all(text, "afinalappropriation", "a final appropriation"),
         text = str_replace_all(text, "institutebiochemistry", "institute biochemistry"),
         text = str_replace_all(text, "threeyearperiod", "three year period"),
         text = str_replace_all(text, "completefinancialstatement", "complete financial statement"),
         text = str_replace_all(text, "foundationrepresents", "foundation represents"),
         text = str_replace_all(text, "tenyearperiod", "ten year period"),
         text = str_replace_all(text, "economichandicaps", "economic handicaps"),
         text = str_replace_all(text, "foreignlanguage", "foreign language"),
         text = str_replace_all(text, "appropriationsfor", "appropriations for"),
         text = str_replace_all(text, "carefullyselected", "carefully selected"),
         text = str_replace_all(text, "chinamedical", "china medical"),
         text = str_replace_all(text, "hokkaidouniversity", "hokkaido university"),
         text = str_replace_all(text, "nationalagricultural", "national agricultural"),
         text = str_replace_all(text, "likelyto", "likely to"),
         text = str_replace_all(text, "socialand", "social and"),
         text = str_replace_all(text, "mobilityregional", "mobility regional"),
         text = str_replace_all(text, "medicalscience", "medical science"),
         text = str_replace_all(text, "beendeveloped", "been developed"),
         text = str_replace_all(text, "includingthe", "including the"),
         text = str_replace_all(text, "andeducation", "and education"),
         text = str_replace_all(text, "advancementof", "advancement of"),
         text = str_replace_all(text, "appropriationsgrants", "appropriations grants"),
         text = str_replace_all(text, "applicantsthe", "applicants the"),
         text = str_replace_all(text, "sectorinnovation", "sector innovation"),
         text = str_replace_all(text, "organizationalbreakthroughs", "organizational breakthroughs"),
         text = str_replace_all(text, "localcommunities", "local communities"),
         text = str_replace_all(text, "coricentrates", "concentrates"),
         text = str_replace_all(text, "cerealresearch", "cereal research"),
         text = str_replace_all(text, "periodadriano", "period adriano"),
         text = str_replace_all(text, "threeyear", "three year"),
         text = str_replace_all(text, "shortterm", "short term"),
         text = str_replace_all(text, "closecooperation", "close cooperation"),
         text = str_replace_all(text, "artistinresidence", "artist in residence"),
         text = str_replace_all(text, "wellbeing(complexities|yet)", "wellbeing \\1"),
         text = str_replace_all(text, "welfare(budgets|in|philip|reform|related|to|work)", "welfare \\1"),
         text = str_replace_all(text, "(community|health|instituteofchild)welfare(recreation|rf)?", "\\1 welfare \\2"),
         text = str_replace_all(text, "instituteofchild", "institute of child"),
         text = str_replace_all(text, "fellowshipsandgrantinatdmpeipingunionmedicalcoilegerf", "fellowships and grant in aid in peiping union medical college"),
         text = str_replace_all(text, "thefieldof", "the field of"),
         text = str_replace_all(text, "paraly sis", "paralysis"),
         text = str_replace_all(text, "tuberculo sis", "tuberculosis"),
         text = str_replace_all(text, "mito sis", "mitosis"),
         text = str_replace_all(text, "morphogene sis", "morphogenesis"),
         text = str_replace_all(text, "empha sis", "emphasis"),
         text = str_replace_all(text, "synthe sis", "synthesis"),
         text = str_replace_all(text, "jniversity", "university"),
         text = str_replace_all(text, "jniversity", "university"),
         text = str_replace_all(text, "rcfkefeller", "rockefeller"),
         text = str_replace_all(text, "hworm", "hookworm"),
         text = str_replace_all(text, "\\bsch\\b", "school"),
         text = str_replace_all(text, "appointedfrom", "appointed from"),
         text = str_replace_all(text, "creativityculture", "creativity culture"),
         text = str_replace_all(text, "\\bcoss", "costs"),
         text = str_replace_all(text, "crosstheme", "cross-theme"),
         text = str_replace_all(text, "esearch", "research"),
         text = str_replace_all(text, "schoolistosomiasis", "schistosomiasis"),
         text = str_replace_all(text, "cerate", "coöperate"),
         text = str_replace_all(text, "sciencebased", "science-based"),
         text = str_replace_all(text, "appointedfrom", "appointed from"),
         text = str_replace_all(text, "annualreport", "annual-report"),
         text = str_replace_all(text, "\\bartis ans", "artisans"),
         text = str_replace_all(text, "\\bartis anal", "artisanal"),
         # text = str_replace_all(text, "\\bagricul", "agriculture"),
         text = str_replace_all(text, "\\bagron omy", "agronomy"),
         text = str_replace_all(text, "\\bagron\\b", "agronomy"),
         text = str_replace_all(text, "\\brresearch", "research"),
         text = str_replace_all(text, "boredhole", "bored-hole"),
         text = str_replace_all(text, "collegeof", "college of"),
         text = str_replace_all(text, "cciences", "sciences"),
         text = str_replace_all(text, "intellectualproperty", "intellectual-property"),
         text = str_replace_all(text, "technologytransfer", "technology transfer"),
         text = str_replace_all(text, "sciencebased", "science-based"),
         text = str_replace_all(text, "\\banal ysis", "analysis"),
         text = str_replace_all(text, "\\bana \\| ysis", "analysis"),
         text = str_replace_all(text, "\\bana ysis", "analysis"),
         text = str_replace_all(text, "\\bana lyze", "analyze"),
         text = str_replace_all(text, "centra", "centro"),
         text = str_replace_all(text, "childh", "childhood"),
         text = str_replace_all(text, "hong kong", "hong-kong"),
         text = str_replace_all(text, "\\bana lyze", "analyze"),
         text = str_replace_all(text, "prob lem(s?)", "problem"),
         text = str_replace_all(text, "prob ably", "probably"),
         text = str_replace_all(text, "cerating", "cooperating"),
         text = str_replace_all(text, "concentrotion", "concentration"),
         text = str_replace_all(text, "\\bnternational", "international"), 
         text = str_replace_all(text, "\\bnternationa", "international"),
         text = str_replace_all(text, "middleincome", "middle-income"),
         text = str_replace_all(text, "coriceptual", "conceptual"),
         text = str_replace_all(text, "fundingfor", "funding for"),
         text = str_replace_all(text, "partlclpatlon", "participation"),
         text = str_replace_all(text, "actlvlties", "activities"),
         text = str_replace_all(text, "instttute", "institute"),
         text = str_replace_all(text, "lts", "its"),
         text = str_replace_all(text, "bepobt", "report"),
         text = str_replace_all(text, "foundationnew", "foundation new"),
         text = str_replace_all(text, "carreldakin", "carrel-dakin"),
         text = str_replace_all(text, "cerative", "cooperative"),
         text = str_replace_all(text, "artistinresidence", "artist in residence"),
         text = str_replace_all(text, "andfor", "and for"),
         text = str_replace_all(text, "trainingfor", "training for"),
         text = str_replace_all(text, "distributionand", "distribution and"),
         text = str_replace_all(text, "communitybased", "community based"),
         text = str_replace_all(text, "programrelated", "program related"),
         text = str_replace_all(text, "climateconscious", "climate-conscious"),
         text = str_replace_all(text, "climaterelated", "climate-related"),
         text = str_replace_all(text, "nongovernmental", "non-governmental"),
         text = str_replace_all(text, "educatlon", "education"),
         text = str_replace_all(text, "materlals", "non-governmental"),
         text = str_replace_all(text, "chlldcare", "childcare"),
         text = str_replace_all(text, "afncan", "african"),
         text = str_replace_all(text, "socialservice", "social-service"),
         text = str_replace_all(text, "nonprofit", "non-profit"),
         text = str_replace_all(text, "theformation", "the formation"),
         text = str_replace_all(text, "towardthe", "toward the"),
         text = str_replace_all(text, "fiscalequitynew", "fiscal equity new"),
         text = str_replace_all(text, "annouriced", "announced"),
         text = str_replace_all(text, "\\bmem\\sber(s)?", "member\\1"),
         text = str_replace_all(text, "resuits", "results"),
         text = str_replace_all(text, "centrol", "central"))




# data.clean.punct <- data.clean.punct  %>% 
#   mutate(text = str_replace_all(text, "resilierice", "resilience"),
#          text = str_replace_all(text, "refererice", "reference"),
#          text = str_replace_all(text, "experierice", "experience"),
#          text = str_replace_all(text, "confererice", "conference"),
#          text = str_replace_all(text, "influerice", "influence"),
#          text = str_replace_all(text, "corresponderice", "correspondence"),
#          text = str_replace_all(text, "independerice", "independence"),
#          text = str_replace_all(text, "scierice", "science"),
#          text = str_replace_all(text, "scierices", "sciences"),
#          text = str_replace_all(text, "balarice", "balance"),
#          text = str_replace_all(text, "florerice", "florence"),
#          text = str_replace_all(text, "preserice", "presence"),
#          text = str_replace_all(text, "intracontmental", "intracontinental"),
#          text = str_replace_all(text, "enharice", "enhace"))

## Changing the class of the object. The best class to see elements within an object is tibble ----
data.clean.no.punct <- tibble(data.clean.no.punct)
save(data.clean.no.punct, file = "data.clean.no.punct.Rda")

data.clean.punct <- tibble(data.clean.punct)
save(data.clean.punct, file = "data.clean.punct.Rda")

# 2nd Cleaning A, we do the tokenisation of the corpus WITHOUT PUNCTUATION and the 2nd layer ----
# of cleaning (removing fragment of words, pseudowords and acronyms 
tokenised.no.punct <- data.clean.no.punct %>% 
  unnest_tokens("words", "text", token = "regex", pattern = "\\s+") %>% 
  filter(!(words %in% c("york", "rockefeller", 1913:2013, 1:10, "rf", "univ", "Rf",
                        "c.m", "dr", "cent", "m.d", "mns", "ph.d", "tion", "par",
                        "agric", "inst", "ing", "ap", "pre", "r.r", "pro",
                        "ooo", "d.c", "san", "coll", "tions", "dc", "acad", 
                        "cont", "mex", "ry", "ser", "cap", "med", "natl", "phd",
                        "med", "meph", "viii", "ix", "x", "xi", "xii", "xiii", "xiv", "xv", 
                        "xvi","xvii", "xviii", "xix", "xx", "xxi", "xxii", "xxiii",
                        "mada", "bmr", "ingagr", "annual","report","ny", 
                        "wwwrockefellerfoundationorgwhat", "appointed", "programs", 
                        "table", "instalments", "remaining", "fig", "hc", "Ih", "|h", 
                        "lh", "percentage", "dh", "pc", "appropria", "mtg", "cort", 
                        "starr", "stoll", "vincent", "ova", "rr", "cum", "cons", "amino",
                        "rfs", "min", "sas", "xn", "los", 
                        "bsc", "shss", "qqq", "qqq", "qoo", "los", "iads", "nev", 
                        "inclen", "foi", "por", "Its", "llc", "rodin", 
                        "Ilc", "greene", "buttrick", "wickliffe", 
                        "ds", "dme", "apr", "barnard", "schillings", "vm", "xin", 
                        "neu", "sheldon", "pfeiffer", "gilardoni","ment", "ments", 
                        "opment", "sion", "tation", "ization", "struction", 
                        "istration", "velopment", "ation", "istration", "lation", 
                        "ration", "zation", "duction", "ganization", "mation",
                        "mentation", "mentation", "provement", "augment", "agement", 
                        "vention", "eration", "fection", "propriation",  "versity", 
                        "ments", "sity", "cation", "dation", "partment", "tration",
                        "sions", "munity", "ness", "ation", "ity","istration",
                        "lation", "divi", "nal", "popul", "educ", "tion", "ration", 
                        "ities","mention", "disserta", "tee", "ro", "cm", "per", 
                        "ref", "vn", "ls", "ga", "g", "c", "h", "dvm", "ms", 
                        "mrs", "w", "ca", "http", "ns", "cd", "pp", "investiga",  
                        "shall","ok", "forl", "backi", "fas", "fss", "appro", 
                        "foundationorg", "smns")))
# TODO include at this level what we have cleaned with the POS.background
save(tokenised.no.punct, file = "tokenised.no.punct.Rda")

# 2nd Cleaning B, we do the tokenisation of the corpus WITH PUNCTUATION and the 2nd layer ----
# of cleaning (removing fragment of words, pseudowords and acronyms
tokenised.punct <- data.clean.punct %>% 
  unnest_tokens("words", "text", token = "regex", pattern = "\\s+") %>% 
  filter(!(words %in% c("york", "rockefeller", 1913:2013, 1:10, "rf", "univ", "Rf",
                        "c.m", "dr", "cent", "m.d", "mns", "ph.d", "tion", "par",
                        "agric", "inst", "ing", "ap", "pre", "r.r", "pro",
                        "ooo", "d.c", "san", "coll", "tions", "dc", "acad", 
                        "cont", "mex", "ry", "ser", "cap", "med", "natl", "phd",
                        "med", "meph", "viii", "ix", "x", "xi", "xii", "xiii", "xiv", "xv", 
                        "xvi","xvii", "xviii", "xix", "xx", "xxi", "xxii", "xxiii",
                        "mada", "bmr", "ingagr", "annual","report","ny", 
                        "wwwrockefellerfoundationorgwhat", "appointed", "programs", 
                        "table", "instalments", "remaining", "fig", "hc", "Ih", "|h", 
                        "lh", "percentage", "dh", "pc", "appropria", "mtg", "cort", 
                        "starr", "stoll", "vincent", "ova", "rr", "cum", "cons", "amino",
                        "rfs", "min", "sas", "xn", "los", 
                        "bsc", "shss", "qqq", "qqq", "qoo", "los", "iads", "nev", 
                        "inclen", "foi", "por", "Its", "llc", "rodin", 
                        "Ilc", "greene", "buttrick", "wickliffe", 
                        "ds", "dme", "apr", "barnard", "schillings", "vm", "xin", 
                        "neu", "sheldon", "pfeiffer", "gilardoni","ment", "ments", 
                        "opment", "sion", "tation", "ization", "struction", 
                        "istration", "velopment", "ation", "istration", "lation", 
                        "ration", "zation", "duction", "ganization", "mation",
                        "mentation", "mentation", "provement", "augment", "agement", 
                        "vention", "eration", "fection", "propriation",  "versity", 
                        "ments", "sity", "cation", "dation", "partment", "tration",
                        "sions", "munity", "ness", "ation", "ity","istration",
                        "lation", "divi", "nal", "popul", "educ", "tion", "ration", 
                        "ities","mention", "disserta", "tee", "ro", "cm", "per", 
                        "ref", "vn", "ls", "ga", "g", "c", "h", "dvm", "ms", 
                        "mrs", "w", "ca", "http", "ns", "cd", "pp", "investiga",  
                        "shall","ok", "forl", "backi", "fas", "fss", "appro", 
                        "foundationorg", "smns")))
save(tokenised.punct, file = "tokenised.punct.Rda")

# Count number of "and" & "the" ----
freq.million <- tokenised.punct %>%
  group_by(Year) %>%
  count(words) %>% 
  mutate(freqmill =((n/sum(n))*1000000)) %>% 
  ungroup()

freq.million.no.punct.nosw <- tokenised.no.punct %>%
  group_by(Year) %>%
  count(words) %>% 
  mutate(freqmill =((n/sum(n))*1000000)) %>% 
  ungroup()

freq.million %>% 
  filter(words %in% c("and", "the"))

# Frequency per million for "and" & "the" per Year ----
freq.million.and <- freq.million %>% 
  filter(words %in% c("and")) %>% 
  summarise(freq.million.and = mean(freqmill)) 

freq.million.the <- freq.million %>% 
  filter(words %in% c("the")) %>% 
  summarise(freq.million.and = mean(freqmill)) 

save(freq.million, freq.million.and, freq.million.the, file = "freq.million.Rda")

# 3rd Cleaning stopwords ----
tokenised.no.punct.nsw <- anti_join(tokenised.no.punct ,stop)
save(tokenised.no.punct.nsw, file = "tokenised.no.punct.nsw.Rda")

# 4th Cleaning ----
tokenised.punct <- tokenised.punct %>%
  mutate(words = str_replace_all(words, "approappropriation", "appropriation"),
         # words = str_delete_all(words, "org"),
         words = str_replace_all(words, "approappropriations", "appropriations"),
         words = str_replace_all(words, "approapproriations", "appropriations"),
         words = str_replace_all(words, "adadministration", "administration"),
         words = str_replace_all(words, "engiricer", "engineer"),
         words = str_replace_all(words, "driveroffice", "driver office"),
         words = str_replace_all(words, "workerschallengebetween", "workers challenge between"),
         words = str_replace_all(words, "andworld", "and world"),
         words = str_replace_all(words, "whileeach", "while each"),
         words = str_replace_all(words, "joinother", "join others"),
         words = str_replace_all(words, "successfuldemostrations", "successful demostrations"),
         words = str_replace_all(words, "promoterenewal", "promote renewal"),
         words = str_replace_all(words, "dcnuclear", "dc nuclear"),
         words = str_replace_all(words, "initiativewhashington", "initiative whashington"),
         words = str_replace_all(words, "progressresolved", "progress resolved"),
         words = str_replace_all(words, "campaingfor", "campaingfor"),
         words = str_replace_all(words, "diseasesurveillance", 
                                 "disease surveillance"),
         words = str_replace_all(words, "networkschallengebecause", 
                                 "networks challenge because"),
         words = str_replace_all(words, "resilienceto", "resilience to"),
         words = str_replace_all(words, "forsmall", "for small"),
         words = str_replace_all(words, "impactinvesting", "impact investing"),
         words = str_replace_all(words, "industrychallengegovernment", 
                                 "industry challeng egovernment"),
         words = str_replace_all(words, "stewardshipjohn", "stewardship john"),
         words = str_replace_all(words, "foundationorgcondensed", "foundation org condensed"),
         words = str_replace_all(words, "activitiesdecember", "activities december"),
         words = str_replace_all(words, "rodinpresident", "rodin president"),
         words = str_replace_all(words, "presidentthe", "president the"),
         words = str_replace_all(words, "foundationorggrantsinescapable", 
                                 "foundation org grants inescapable"),
         words = str_replace_all(words, "withmore", "with more"),
         words = str_replace_all(words, "bostonhenry", "boston henry"),
         words = str_replace_all(words, "andthe", "and the"),
         words = str_replace_all(words, "countyhealth", "county health"),
         words = str_replace_all(words, "uponthe", "upon the"),
         words = str_replace_all(words, "wasreopened", "was reopened"),
         words = str_replace_all(words, "boardsrepresentative", 
                                 "boards representative"),
         words = str_replace_all(words, "thesanitary", "the sanitary"),
         words = str_replace_all(words, "weregranted", "were granted"),
         words = str_replace_all(words, "hadbeen", "had been"),
         words = str_replace_all(words, "variousprojects", "various projects"),
         words = str_replace_all(words, "servicesof", "service sof"),
         words = str_replace_all(words, "bythe", "by the"),
         words = str_replace_all(words, "waspermitted", "was permitted"),
         words = str_replace_all(words, "intoconsultation", "into consultation"),
         words = str_replace_all(words, "supplysystem", "supply system"),
         words = str_replace_all(words, "baltimoredonald", "baltimore donald"),
         words = str_replace_all(words, "adviserand", "adviser and"),
         words = str_replace_all(words, "yorkgeorge", "york george"),
         words = str_replace_all(words, "mainte nance", "maintenance"), 
         words = str_replace_all(words, "thevenereal", "the venereal"),
         words = str_replace_all(words, "iscorrelated", "is correlated"),
         words = str_replace_all(words, "epidemiologistwithin", "epidemiologist within"),
         words = str_replace_all(words, "tohonduras", "to honduras"),
         words = str_replace_all(words, "cooperativeprogram", "cooperative program"),
         words = str_replace_all(words, "madesurveys", "made surveys"),
         words = str_replace_all(words, "stationedin", "stationedin"),
         words = str_replace_all(words, "assistancein", "assistance in"),
         words = str_replace_all(words, "operationhookworm", "operation hookworm"),
         words = str_replace_all(words, "atechnical", "a technical"),
         words = str_replace_all(words, "amedical", "amedical"),
         words = str_replace_all(words, "otherplaces", "otherplaces"),
         words = str_replace_all(words, "undergovernmental", "undergovernmental"),
         words = str_replace_all(words, "hehas", "he has"),
         words = str_replace_all(words, "giveadvice", "give advice"),
         words = str_replace_all(words, "thecontrol", "the control"),
         words = str_replace_all(words, "statessanitary", "states sanitary"),
         words = str_replace_all(words, "malariastudies", "malaria studies"),
         words = str_replace_all(words, "servicesof", "services of"),
         words = str_replace_all(words, "ahonduran", "a honduran"),
         words = str_replace_all(words, "ingeneral", "in general"),
         words = str_replace_all(words, "bylending", "by lending"),
         words = str_replace_all(words, "fieldpersonnel", "field personnel"),
         words = str_replace_all(words, "physiciansone", "physicians one"),
         words = str_replace_all(words, "appropriationsa", "appropriations a"),
         words = str_replace_all(words, "healthwith", "health with"),
         words = str_replace_all(words, "underthe", "under the"),
         words = str_replace_all(words, "theservices", "the services"),
         words = str_replace_all(words, "localityin", "localityin"),
         words = str_replace_all(words, "inmany", "in many"),
         words = str_replace_all(words, "availablethe", "available the"),
         words = str_replace_all(words, "drainagesystem", "drainage system"),
         words = str_replace_all(words, "nationaldepartment", "national department"),
         words = str_replace_all(words, "localsanitary", "local sanitary"),
         words = str_replace_all(words, "themthe", "them the"),
         words = str_replace_all(words, "watersupply", "water supply"),
         words = str_replace_all(words, "departmentin", "department in"),
         words = str_replace_all(words, "foundationcontinued", "foundation continued"),
         words = str_replace_all(words, "malariologistand", "malariologist and"),
         words = str_replace_all(words, "theproblem", "the problem"),
         words = str_replace_all(words, "drainagethe", "drainage the"),
         words = str_replace_all(words, "adjacentuntiled", "adjacent untiled"),
         words = str_replace_all(words, "wasoffered", "was offered"),
         words = str_replace_all(words, "foundationssanitary", "foundations sanitary"),
         words = str_replace_all(words, "theunited", "the united"),
         words = str_replace_all(words, "expectedthat", "expected that"),
         words = str_replace_all(words, "hondurasearly", "honduras early"),
         words = str_replace_all(words, "hondurasa", "honduras a"),
         words = str_replace_all(words, "otherplaces", "other places"),
         words = str_replace_all(words, "undergovernmental", "under governmental"),
         words = str_replace_all(words, "servicein", "service in"),
         words = str_replace_all(words, "furnishedby", "furnished by"),
         words = str_replace_all(words, "malariastudies", "malaria studies"),
         words = str_replace_all(words, "controlin", "control in"),
         words = str_replace_all(words, "fordrainage", "for drainage"),
         words = str_replace_all(words, "furthertests", "further tests"),
         words = str_replace_all(words, "divisionin", "division in"),
         words = str_replace_all(words, "nicaraguacontinued", "nicaragua continued"),
         words = str_replace_all(words, "adivision", "a division"),
         words = str_replace_all(words, "governmenthaving", "government having"),
         words = str_replace_all(words, "ofthe ", "of the "),
         words = str_replace_all(words, "representativeserved", "representative served"),
         words = str_replace_all(words, "giveexpert", "give expert"),
         words = str_replace_all(words, "atwoyear", "a two year"),
         words = str_replace_all(words, "andthree", "and three"),
         words = str_replace_all(words, "latelybeen", "lately been"),
         words = str_replace_all(words, "mechanicalequipmentfillinga", 
                                 "mechanical equipment filling a"),
         words = str_replace_all(words, "breedingplace", "breeding place"),
         words = str_replace_all(words, "foundationfor", "foundation for"),
         words = str_replace_all(words, "prepareda", "prepared a"),
         words = str_replace_all(words, "beenlent", "been lent"),
         words = str_replace_all(words, "foundationto", "foundation to"),
         words = str_replace_all(words, "beingtrained", "being trained"),
         words = str_replace_all(words, "foundationfellowship", "foundation fellowship"),
         words = str_replace_all(words, "hondurasand", "honduras and"),
         words = str_replace_all(words, "installinga", "installing a"),
         words = str_replace_all(words, "themthe", "them the"),
         words = str_replace_all(words, "ofceylon", "of ceylon"),
         words = str_replace_all(words, "observationa", "observation a"),
         words = str_replace_all(words, "inthis", "in this"),
         words = str_replace_all(words, "furnishedby", "furnished by"),
         words = str_replace_all(words, "corporationswho", "corporations who"),
         words = str_replace_all(words, "infieldsketchingand", "in field sketching and"),
         words = str_replace_all(words, "sectionof", "section of"),
         words = str_replace_all(words, "maintainsheadquarters", "maintains headquarters"),
         words = str_replace_all(words, "aidedthis", "aided this"),
         words = str_replace_all(words, "asanitarytwoyear", "a sanitary two year"),
         words = str_replace_all(words, "bureauboredhole", "bureau bored hole"),
         words = str_replace_all(words, "departmentsbureauboredhole", 
                                 "departments bureau bored hole"),
         words = str_replace_all(words, "succesfullyinstalled", "succesfully installed"),
         words = str_replace_all(words, "villagesattention", "villages attention"),
         words = str_replace_all(words, "innorth", "in north"),
         words = str_replace_all(words, "practicableroutine", "practicable routine"),
         words = str_replace_all(words, "entomologistcollaborate", "entomologist collaborate"),
         words = str_replace_all(words, "foundationthe", "foundation the"),
         words = str_replace_all(words, "andof", "and of"),
         words = str_replace_all(words, "electroenceph alographyjohns", 
                                 "electroencephalography johns"),   
         words = str_replace_all(words, "europeedinburgh", "europe edinburgh"),
         words = str_replace_all(words, "institutionsgeorgia", "institutions georgia"),
         words = str_replace_all(words, "greecegermany", "greece germany"),
         words = str_replace_all(words, "fultonmontgomery", "fulton montgomery"),
         words = str_replace_all(words, "twonutritionists", "two nutritionists"),
         words = str_replace_all(words, "medicalschools", "medical schools"),
         words = str_replace_all(words, "therequest", "the request"),
         words = str_replace_all(words, "inbarranquilla", "in barranquilla"),
         words = str_replace_all(words, "anentomologist", "an entomologist"),
         words = str_replace_all(words, "staffmember", "staff member"),
         words = str_replace_all(words, "sanitarianthe", "sanitarian the"),
         words = str_replace_all(words, "providingsalaries", "providingsalaries"),
         words = str_replace_all(words, "commissionmade", "commission made"),
         words = str_replace_all(words, "intermittentlythe", "intermittently the"),
         words = str_replace_all(words, "medicalcommission", "medical commission"),
         words = str_replace_all(words, "factorsspecial", "factors special"),
         words = str_replace_all(words, "provedthat", "proved that"),
         words = str_replace_all(words, "thisregion", "this region"),
         words = str_replace_all(words, "wellestablished", "well established"),
         words = str_replace_all(words, "insuresnormal", "insures normal"),
         words = str_replace_all(words, "staffhas", "staff has"),
         words = str_replace_all(words, "antiguamontserrat vincentgrenadines luciadominica", 
                                 "antigua montserrat vincent grenadines lucia dominica"),
         words = str_replace_all(words, "incharge", "in charge"),
         words = str_replace_all(words, "ineurope", "in europe"),
         words = str_replace_all(words, "phaseof", "phase of"),
         words = str_replace_all(words, "researchphysicist", "research physicist"),
         words = str_replace_all(words, "withthe", "with the"),
         words = str_replace_all(words, "agriculturecomprised", "agriculture comprised"),
         words = str_replace_all(words, "anddoctor", "and doctor"),
         words = str_replace_all(words, "andsince", "and since"),
         words = str_replace_all(words, "auxiliaryworkers", "auxiliary workers"),
         words = str_replace_all(words, "subsequentobservation", "subsequent observation"),
         words = str_replace_all(words, "physiciansnurses", "physicians nurses"),
         words = str_replace_all(words, "equipmentgeorge", "equipment george"),
         words = str_replace_all(words, "worksengland", "works england"),
         words = str_replace_all(words, "draftsmen", "draft smen"),
         words = str_replace_all(words, "andsecretaries", "and secretaries"),
         words = str_replace_all(words, "yorkadditional", "york additional"),
         words = str_replace_all(words, "obstetricsand", "obstetrics and"),
         words = str_replace_all(words, "thetheatre", "the theatre"),
         words = str_replace_all(words, "museumlighting", "museum lighting"),
         words = str_replace_all(words, "governmentof", "government of"),
         words = str_replace_all(words, "screeningor", "screening or"),
         words = str_replace_all(words, "formfiltrationhas", "form filtration has"),
         words = str_replace_all(words, "recentbiological", "recent biological"),
         words = str_replace_all(words, "themathematician", "the mathematician"),
         words = str_replace_all(words, "analysisof", "analysis of"),
         words = str_replace_all(words, "lectromagneticfieldwhenan",
                                 "electromagnetic field when an"),
         words = str_replace_all(words, "meanta", "meant a"),
         words = str_replace_all(words, "peopledevelopment", "people development"),
         words = str_replace_all(words, "geneticistarthur", "geneticis tarthur"),
         words = str_replace_all(words, "agriculturewhich", "agriculture which"),
         words = str_replace_all(words, "themathematician", "the mathematician"),
         words = str_replace_all(words, "trainedprofessional", "trained professional"),
         words = str_replace_all(words, "foundationcolombiabogotacolombian", 
                                 "foundation colombia bogota colombian"),
         words = str_replace_all(words, "peopledevelopment", "people development"),
         words = str_replace_all(words, "foundationorgwhat", "foundation what"),
         words = str_replace_all(words, "foundationorgthese", "foundation these"),
         words = str_replace_all(words, "foundationrogduring", "foundation during"),
         words = str_replace_all(words, "theprovirice", "the province"),
         words = str_replace_all(words, "sanitaryengiricering", "sanitary engineering"),
         words = str_replace_all(words, "engiricerprovided", "engineer provided"),
         words = str_replace_all(words, "antimalariaengiricering", "antimalaria engineering"),
         words = str_replace_all(words, "engiriceringdepartment", "engineering department"),
         words = str_replace_all(words, "wellequippedlaboratory", "well equipped laboratory"),
         words = str_replace_all(words, "fundamentalstudies", "fundamental studies"),
         words = str_replace_all(words, "governmentfor", "government for"),
         words = str_replace_all(words, "presidentialdecree", "presidential decree"),
         words = str_replace_all(words, "humangenetics", "human genetics"),
         words = str_replace_all(words, "napleshas thefirstto", "naples has the first to"),
         words = str_replace_all(words, "governmentdevelopment", "government development"),
         words = str_replace_all(words, "environmentalsanitation", "environmental sanitation"),
         words = str_replace_all(words, "connectionwith", "connectio nwith"),
         words = str_replace_all(words, "increasingthe", "increasing the"),
         words = str_replace_all(words, "departmentsof", "departments of"),
         words = str_replace_all(words, "generalhealth", "general health"),
         words = str_replace_all(words, "anddynamic", "and dynamic"),
         words = str_replace_all(words, "asuniversity", "as university"),
         words = str_replace_all(words, "berlindahlem", "berlin dahlem"),
         words = str_replace_all(words, "andlandscape", "and landscape"),
         words = str_replace_all(words, "departmentof", "department of"),
         words = str_replace_all(words, "developmentof", "development of"),
         words = str_replace_all(words, "foundationsciencebased", "foundation science based"),
         words = str_replace_all(words, "atrisk", "at risk"),
         words = str_replace_all(words, "glycerinesalt", "glycerine salt"),
         words = str_replace_all(words, "budgetcontinued", "budget continued"),
         words = str_replace_all(words, "searchlight", "search light"),
         words = str_replace_all(words, "acquisitionloan", "acquisition loan"),
         words = str_replace_all(words, "massachusettsharvard", "massachusetts harvard"),
         words = str_replace_all(words, "medicalboard", "medical board"),
         words = str_replace_all(words, "ofa", "of a"),
         words = str_replace_all(words, "foundationhas", "foundation has"),
         words = str_replace_all(words, "developmgcountry", "developing country"),
         words = str_replace_all(words, "contraceptivesand", "contraceptives and"),
         words = str_replace_all(words, "hereworkinprogress", "here work in progress"),
         words = str_replace_all(words, "kcontinued", "k-continued"),
         words = str_replace_all(words, "paymentsmissionary", "payment smissionary"),
         words = str_replace_all(words, "societieshos pitals", "societies hospitals"),
         words = str_replace_all(words, "ofinternational", "of international"),
         words = str_replace_all(words, "thcentury", "th century"),
         words = str_replace_all(words, "thecountry", "the country"),
         words = str_replace_all(words, "thegeneral", "the general"),
         words = str_replace_all(words, "thhealth", "the health"),
         words = str_replace_all(words, "activitiescontinued", "activities continued"),
         words = str_replace_all(words, "developmentcontinued", "development continued"),
         words = str_replace_all(words, "programscontinued", "programs continued"),
         words = str_replace_all(words, "organizationscontinued", "organizations continued"),
         words = str_replace_all(words, "institutionscontinued", "institutions continued"),
         words = str_replace_all(words, "paymentsgeneral", "payments general"),
         words = str_replace_all(words, "payments research", "payments research"),
         words = str_replace_all(words, "dcontinued", "continued"),
         words = str_replace_all(words, "requirementscontinued", "requirements continued"),
         words = str_replace_all(words, "educationalcontinued", "educational continued"),
         words = str_replace_all(words, "schoolcontinued", "school continued"),
         words = str_replace_all(words, "budgetcontinued", "budget continued"),
         words = str_replace_all(words, "countriescontinued", "countries continued"),
         words = str_replace_all(words, "europecontinued", "europe continued"),
         words = str_replace_all(words, "statescontinued", "states continued"),
         words = str_replace_all(words, "paymentspublic", "payments public"),
         words = str_replace_all(words, "centerfor", "center for"),
         words = str_replace_all(words, "sciencebased", "science based"),
         words = str_replace_all(words, "agncultural", "agricultural"),
         words = str_replace_all(words, "costof", "cost of"),
         words = str_replace_all(words, "costsof", "costs of"),
         words = str_replace_all(words, "amencan", "american"),
         words = str_replace_all(words, "capacitybuilding", "capacity building"),
         words = str_replace_all(words, "civilsocietyorganizations", 
                                 "civil society organizations"),
         words = str_replace_all(words, "fouryear", "four year"),
         words = str_replace_all(words, "droughttolerant", "drought tolerant"),
         words = str_replace_all(words, "appbopria", "appropriations"),
         words = str_replace_all(words, "annourices", "announces"),
         words = str_replace_all(words, "chma", "china"),
         words = str_replace_all(words, "developmentand", "development and"),
         words = str_replace_all(words, "foodand", "food and"),
         # words = str_replace_all(words, "nomirices", "nominees"),
         words = str_replace_all(words, "erice$", "ence"),
         words = str_replace_all(words, "erices$", "ences"),
         words = str_replace_all(words, "engiricering", "engineering"),
         words = str_replace_all(words, "coricerning", "concerning"),
         words = str_replace_all(words, "(arice)(.*)", "ance\\2"),
         words = str_replace_all(words, "(erice)(.*)", "ence\\2"),
         words = str_replace_all(words, "(irice)(.*)", "ince\\2"),
         words = str_replace_all(words, "(irice)(.*)", "ince\\2"),
         words = str_replace_all(words, "schoololarships", "scholarships"),
         words = str_replace_all(words, "artistinresidence", "artist in residence"),
         words = str_replace_all(words, "byaws", "by-laws"),
         words = str_replace_all(words, "newyorkcity", "new york city"),
         words = str_replace_all(words, "arc", "are"),
         words = str_replace_all(words, "afiveearperiod", "a five year period"),
         words = str_replace_all(words, "beview", "review"),
         words = str_replace_all(words, "composernesidence", "composer-in-residence"),
         words = str_replace_all(words, "inervice", "in-service"),
         words = str_replace_all(words, "\\bdesigna\\b", "designations"),
         words = str_replace_all(words, "berlinahlem", "berlin-dahlem"),
         words = str_replace_all(words, "andexplorations", "and explorations"),
         words = str_replace_all(words, "universityof", "university of"),
         words = str_replace_all(words, "ph.d.", "ph.d"),
         words = str_replace_all(words, "associa", "association"),
         words = str_replace_all(words, "\\bbabwe", "zimbabwe"),
         words = str_replace_all(words, "ogyscnpps", "scripps"),
         words = str_replace_all(words, "biotechnol\\b", "biotechnology"),
         words = str_replace_all(words, "sociol\\b", "sociology"),
         words = str_replace_all(words, "coricert", "concert"),
         words = str_replace_all(words, "ourwork", "our work"),
         words = str_replace_all(words, "arehaeology", "archaeology"),
         words = str_replace_all(words, "appbopbia", "appropriation"),
         words = str_replace_all(words, "researeh", "research"), 
         words = str_replace_all(words, "colomb\\b", "colombia"),
         words = str_replace_all(words, "minorityroup", "minority group"),
         words = str_replace_all(words, "artisthesidence", "artist in residence"),
         words = str_replace_all(words, "avantarde", "avantgarde"), 
         words = str_replace_all(words, "associationte", "associate"),
         words = str_replace_all(words, "atisk", "at-risk"),
         words = str_replace_all(words, "-support", "support"),
         words = str_replace_all(words, "-salary", "salary"),
         words = str_replace_all(words, "\\bmex\\.\\b", "mexico"),
         words = str_replace_all(words, "\\bcommis\\b", "commission"),
         words = str_replace_all(words, "\\bconsol\\b", "consolidation"),
         words = str_replace_all(words, "\\bcontribu\\b", "contribution"),
         words = str_replace_all(words, "renfection", "reinfection"),
         words = str_replace_all(words, "\\bpsy\\schiatry", "psychiatry")) %>% 
  filter(!(words %in% c("tory", "tional", "tural", "ture", "cal", "medi", "na", 
                        "cul","©", "v", "f", "r", "p", "e", "t", "l", "m", "n", 
                        "b", "m.s", "na", "fe", "ab", "db", "appbopbu", 
                        "apphopbia", "tionb", "tlona", "$", "mem", "ix", "viii",
                        "ogy", "sr.", "—a", "sss", "—lh", "—salary", "—support", 
                        "pp", "©rants", "mr", "mr.", "&m","à", "—dr", "ip", 
                        "ooo", "ps", "da", "b.sc", ".ft", "a.", "sr.", "a.b.",
                        "a.m.", "univ.", ".v.m", "xmv", "am", "cc", "du", "candi")))

tokenised.no.punct.nsw <- tokenised.no.punct.nsw %>%
  mutate(words = str_replace_all(words, "approappropriation", "appropriation"),
         # words = str_delete_all(words, "org"),
         words = str_replace_all(words, "approappropriations", "appropriations"),
         words = str_replace_all(words, "approapproriations", "appropriations"),
         words = str_replace_all(words, "adadministration", "administration"),
         words = str_replace_all(words, "engiricer", "engineer"),
         words = str_replace_all(words, "driveroffice", "driver office"),
         words = str_replace_all(words, "workerschallengebetween", "workers challenge between"),
         words = str_replace_all(words, "andworld", "and world"),
         words = str_replace_all(words, "whileeach", "while each"),
         words = str_replace_all(words, "joinother", "join others"),
         words = str_replace_all(words, "successfuldemostrations", "successful demostrations"),
         words = str_replace_all(words, "promoterenewal", "promote renewal"),
         words = str_replace_all(words, "dcnuclear", "dc nuclear"),
         words = str_replace_all(words, "initiativewhashington", "initiative whashington"),
         words = str_replace_all(words, "progressresolved", "progress resolved"),
         words = str_replace_all(words, "campaingfor", "campaingfor"),
         words = str_replace_all(words, "diseasesurveillance", 
                                 "disease surveillance"),
         words = str_replace_all(words, "networkschallengebecause", 
                                 "networks challenge because"),
         words = str_replace_all(words, "resilienceto", "resilience to"),
         words = str_replace_all(words, "forsmall", "for small"),
         words = str_replace_all(words, "impactinvesting", "impact investing"),
         words = str_replace_all(words, "industrychallengegovernment", 
                                 "industry challeng egovernment"),
         words = str_replace_all(words, "stewardshipjohn", "stewardship john"),
         words = str_replace_all(words, "foundationorgcondensed", "foundation org condensed"),
         words = str_replace_all(words, "activitiesdecember", "activities december"),
         words = str_replace_all(words, "rodinpresident", "rodin president"),
         words = str_replace_all(words, "presidentthe", "president the"),
         words = str_replace_all(words, "foundationorggrantsinescapable", 
                                 "foundation org grants inescapable"),
         words = str_replace_all(words, "withmore", "with more"),
         words = str_replace_all(words, "bostonhenry", "boston henry"),
         words = str_replace_all(words, "andthe", "and the"),
         words = str_replace_all(words, "countyhealth", "county health"),
         words = str_replace_all(words, "uponthe", "upon the"),
         words = str_replace_all(words, "wasreopened", "was reopened"),
         words = str_replace_all(words, "boardsrepresentative", 
                                 "boards representative"),
         words = str_replace_all(words, "thesanitary", "the sanitary"),
         words = str_replace_all(words, "weregranted", "were granted"),
         words = str_replace_all(words, "hadbeen", "had been"),
         words = str_replace_all(words, "variousprojects", "various projects"),
         words = str_replace_all(words, "servicesof", "service sof"),
         words = str_replace_all(words, "bythe", "by the"),
         words = str_replace_all(words, "waspermitted", "was permitted"),
         words = str_replace_all(words, "intoconsultation", "into consultation"),
         words = str_replace_all(words, "supplysystem", "supply system"),
         words = str_replace_all(words, "baltimoredonald", "baltimore donald"),
         words = str_replace_all(words, "adviserand", "adviser and"),
         words = str_replace_all(words, "yorkgeorge", "york george"),
         words = str_replace_all(words, "mainte nance", "maintenance"), 
         words = str_replace_all(words, "thevenereal", "the venereal"),
         words = str_replace_all(words, "iscorrelated", "is correlated"),
         words = str_replace_all(words, "epidemiologistwithin", "epidemiologist within"),
         words = str_replace_all(words, "tohonduras", "to honduras"),
         words = str_replace_all(words, "cooperativeprogram", "cooperative program"),
         words = str_replace_all(words, "madesurveys", "made surveys"),
         words = str_replace_all(words, "stationedin", "stationedin"),
         words = str_replace_all(words, "assistancein", "assistance in"),
         words = str_replace_all(words, "operationhookworm", "operation hookworm"),
         words = str_replace_all(words, "atechnical", "a technical"),
         words = str_replace_all(words, "amedical", "amedical"),
         words = str_replace_all(words, "otherplaces", "otherplaces"),
         words = str_replace_all(words, "undergovernmental", "undergovernmental"),
         words = str_replace_all(words, "hehas", "he has"),
         words = str_replace_all(words, "giveadvice", "give advice"),
         words = str_replace_all(words, "thecontrol", "the control"),
         words = str_replace_all(words, "statessanitary", "states sanitary"),
         words = str_replace_all(words, "malariastudies", "malaria studies"),
         words = str_replace_all(words, "servicesof", "services of"),
         words = str_replace_all(words, "ahonduran", "a honduran"),
         words = str_replace_all(words, "ingeneral", "in general"),
         words = str_replace_all(words, "bylending", "by lending"),
         words = str_replace_all(words, "fieldpersonnel", "field personnel"),
         words = str_replace_all(words, "physiciansone", "physicians one"),
         words = str_replace_all(words, "appropriationsa", "appropriations a"),
         words = str_replace_all(words, "healthwith", "health with"),
         words = str_replace_all(words, "underthe", "under the"),
         words = str_replace_all(words, "theservices", "the services"),
         words = str_replace_all(words, "localityin", "localityin"),
         words = str_replace_all(words, "inmany", "in many"),
         words = str_replace_all(words, "availablethe", "available the"),
         words = str_replace_all(words, "drainagesystem", "drainage system"),
         words = str_replace_all(words, "nationaldepartment", "national department"),
         words = str_replace_all(words, "localsanitary", "local sanitary"),
         words = str_replace_all(words, "themthe", "them the"),
         words = str_replace_all(words, "watersupply", "water supply"),
         words = str_replace_all(words, "departmentin", "department in"),
         words = str_replace_all(words, "foundationcontinued", "foundation continued"),
         words = str_replace_all(words, "malariologistand", "malariologist and"),
         words = str_replace_all(words, "theproblem", "the problem"),
         words = str_replace_all(words, "drainagethe", "drainage the"),
         words = str_replace_all(words, "adjacentuntiled", "adjacent untiled"),
         words = str_replace_all(words, "wasoffered", "was offered"),
         words = str_replace_all(words, "foundationssanitary", "foundations sanitary"),
         words = str_replace_all(words, "theunited", "the united"),
         words = str_replace_all(words, "expectedthat", "expected that"),
         words = str_replace_all(words, "hondurasearly", "honduras early"),
         words = str_replace_all(words, "hondurasa", "honduras a"),
         words = str_replace_all(words, "otherplaces", "other places"),
         words = str_replace_all(words, "undergovernmental", "under governmental"),
         words = str_replace_all(words, "servicein", "service in"),
         words = str_replace_all(words, "furnishedby", "furnished by"),
         words = str_replace_all(words, "malariastudies", "malaria studies"),
         words = str_replace_all(words, "controlin", "control in"),
         words = str_replace_all(words, "fordrainage", "for drainage"),
         words = str_replace_all(words, "furthertests", "further tests"),
         words = str_replace_all(words, "divisionin", "division in"),
         words = str_replace_all(words, "nicaraguacontinued", "nicaragua continued"),
         words = str_replace_all(words, "adivision", "a division"),
         words = str_replace_all(words, "governmenthaving", "government having"),
         words = str_replace_all(words, "ofthe ", "of the "),
         words = str_replace_all(words, "representativeserved", "representative served"),
         words = str_replace_all(words, "giveexpert", "give expert"),
         words = str_replace_all(words, "atwoyear", "a two year"),
         words = str_replace_all(words, "andthree", "and three"),
         words = str_replace_all(words, "latelybeen", "lately been"),
         words = str_replace_all(words, "mechanicalequipmentfillinga", 
                                 "mechanical equipment filling a"),
         words = str_replace_all(words, "breedingplace", "breeding place"),
         words = str_replace_all(words, "foundationfor", "foundation for"),
         words = str_replace_all(words, "prepareda", "prepared a"),
         words = str_replace_all(words, "beenlent", "been lent"),
         words = str_replace_all(words, "foundationto", "foundation to"),
         words = str_replace_all(words, "beingtrained", "being trained"),
         words = str_replace_all(words, "foundationfellowship", "foundation fellowship"),
         words = str_replace_all(words, "hondurasand", "honduras and"),
         words = str_replace_all(words, "installinga", "installing a"),
         words = str_replace_all(words, "themthe", "them the"),
         words = str_replace_all(words, "ofceylon", "of ceylon"),
         words = str_replace_all(words, "observationa", "observation a"),
         words = str_replace_all(words, "inthis", "in this"),
         words = str_replace_all(words, "furnishedby", "furnished by"),
         words = str_replace_all(words, "corporationswho", "corporations who"),
         words = str_replace_all(words, "infieldsketchingand", "in field sketching and"),
         words = str_replace_all(words, "sectionof", "section of"),
         words = str_replace_all(words, "maintainsheadquarters", "maintains headquarters"),
         words = str_replace_all(words, "aidedthis", "aided this"),
         words = str_replace_all(words, "asanitarytwoyear", "a sanitary two year"),
         words = str_replace_all(words, "bureauboredhole", "bureau bored hole"),
         words = str_replace_all(words, "departmentsbureauboredhole", 
                                 "departments bureau bored hole"),
         words = str_replace_all(words, "succesfullyinstalled", "succesfully installed"),
         words = str_replace_all(words, "villagesattention", "villages attention"),
         words = str_replace_all(words, "innorth", "in north"),
         words = str_replace_all(words, "practicableroutine", "practicable routine"),
         words = str_replace_all(words, "entomologistcollaborate", "entomologist collaborate"),
         words = str_replace_all(words, "foundationthe", "foundation the"),
         words = str_replace_all(words, "andof", "and of"),
         words = str_replace_all(words, "electroenceph alographyjohns", 
                                 "electroencephalography johns"),   
         words = str_replace_all(words, "europeedinburgh", "europe edinburgh"),
         words = str_replace_all(words, "institutionsgeorgia", "institutions georgia"),
         words = str_replace_all(words, "greecegermany", "greece germany"),
         words = str_replace_all(words, "fultonmontgomery", "fulton montgomery"),
         words = str_replace_all(words, "twonutritionists", "two nutritionists"),
         words = str_replace_all(words, "medicalschools", "medical schools"),
         words = str_replace_all(words, "therequest", "the request"),
         words = str_replace_all(words, "inbarranquilla", "in barranquilla"),
         words = str_replace_all(words, "anentomologist", "an entomologist"),
         words = str_replace_all(words, "staffmember", "staff member"),
         words = str_replace_all(words, "sanitarianthe", "sanitarian the"),
         words = str_replace_all(words, "providingsalaries", "providingsalaries"),
         words = str_replace_all(words, "commissionmade", "commission made"),
         words = str_replace_all(words, "intermittentlythe", "intermittently the"),
         words = str_replace_all(words, "medicalcommission", "medical commission"),
         words = str_replace_all(words, "factorsspecial", "factors special"),
         words = str_replace_all(words, "provedthat", "proved that"),
         words = str_replace_all(words, "thisregion", "this region"),
         words = str_replace_all(words, "wellestablished", "well established"),
         words = str_replace_all(words, "insuresnormal", "insures normal"),
         words = str_replace_all(words, "staffhas", "staff has"),
         words = str_replace_all(words, "antiguamontserrat vincentgrenadines luciadominica", 
                                 "antigua montserrat vincent grenadines lucia dominica"),
         words = str_replace_all(words, "incharge", "in charge"),
         words = str_replace_all(words, "ineurope", "in europe"),
         words = str_replace_all(words, "phaseof", "phase of"),
         words = str_replace_all(words, "researchphysicist", "research physicist"),
         words = str_replace_all(words, "withthe", "with the"),
         words = str_replace_all(words, "agriculturecomprised", "agriculture comprised"),
         words = str_replace_all(words, "anddoctor", "and doctor"),
         words = str_replace_all(words, "andsince", "and since"),
         words = str_replace_all(words, "auxiliaryworkers", "auxiliary workers"),
         words = str_replace_all(words, "subsequentobservation", "subsequent observation"),
         words = str_replace_all(words, "physiciansnurses", "physicians nurses"),
         words = str_replace_all(words, "equipmentgeorge", "equipment george"),
         words = str_replace_all(words, "worksengland", "works england"),
         words = str_replace_all(words, "draftsmen", "draft smen"),
         words = str_replace_all(words, "andsecretaries", "and secretaries"),
         words = str_replace_all(words, "yorkadditional", "york additional"),
         words = str_replace_all(words, "obstetricsand", "obstetrics and"),
         words = str_replace_all(words, "thetheatre", "the theatre"),
         words = str_replace_all(words, "museumlighting", "museum lighting"),
         words = str_replace_all(words, "governmentof", "government of"),
         words = str_replace_all(words, "screeningor", "screening or"),
         words = str_replace_all(words, "formfiltrationhas", "form filtration has"),
         words = str_replace_all(words, "recentbiological", "recent biological"),
         words = str_replace_all(words, "themathematician", "the mathematician"),
         words = str_replace_all(words, "analysisof", "analysis of"),
         words = str_replace_all(words, "lectromagneticfieldwhenan",
                                 "electromagnetic field when an"),
         words = str_replace_all(words, "meanta", "meant a"),
         words = str_replace_all(words, "peopledevelopment", "people development"),
         words = str_replace_all(words, "geneticistarthur", "geneticis tarthur"),
         words = str_replace_all(words, "agriculturewhich", "agriculture which"),
         words = str_replace_all(words, "themathematician", "the mathematician"),
         words = str_replace_all(words, "trainedprofessional", "trained professional"),
         words = str_replace_all(words, "foundationcolombiabogotacolombian", 
                                 "foundation colombia bogota colombian"),
         words = str_replace_all(words, "peopledevelopment", "people development"),
         words = str_replace_all(words, "foundationorgwhat", "foundation what"),
         words = str_replace_all(words, "foundationorgthese", "foundation these"),
         words = str_replace_all(words, "foundationrogduring", "foundation during"),
         words = str_replace_all(words, "theprovirice", "the province"),
         words = str_replace_all(words, "sanitaryengiricering", "sanitary engineering"),
         words = str_replace_all(words, "engiricerprovided", "engineer provided"),
         words = str_replace_all(words, "antimalariaengiricering", "antimalaria engineering"),
         words = str_replace_all(words, "engiriceringdepartment", "engineering department"),
         words = str_replace_all(words, "wellequippedlaboratory", "well equipped laboratory"),
         words = str_replace_all(words, "fundamentalstudies", "fundamental studies"),
         words = str_replace_all(words, "governmentfor", "government for"),
         words = str_replace_all(words, "presidentialdecree", "presidential decree"),
         words = str_replace_all(words, "humangenetics", "human genetics"),
         words = str_replace_all(words, "napleshas thefirstto", "naples has the first to"),
         words = str_replace_all(words, "governmentdevelopment", "government development"),
         words = str_replace_all(words, "environmentalsanitation", "environmental sanitation"),
         words = str_replace_all(words, "connectionwith", "connectio nwith"),
         words = str_replace_all(words, "increasingthe", "increasing the"),
         words = str_replace_all(words, "departmentsof", "departments of"),
         words = str_replace_all(words, "generalhealth", "general health"),
         words = str_replace_all(words, "anddynamic", "and dynamic"),
         words = str_replace_all(words, "asuniversity", "as university"),
         words = str_replace_all(words, "berlindahlem", "berlin dahlem"),
         words = str_replace_all(words, "andlandscape", "and landscape"),
         words = str_replace_all(words, "departmentof", "department of"),
         words = str_replace_all(words, "developmentof", "development of"),
         words = str_replace_all(words, "foundationsciencebased", "foundation science based"),
         words = str_replace_all(words, "atrisk", "at risk"),
         words = str_replace_all(words, "glycerinesalt", "glycerine salt"),
         words = str_replace_all(words, "budgetcontinued", "budget continued"),
         words = str_replace_all(words, "searchlight", "search light"),
         words = str_replace_all(words, "acquisitionloan", "acquisition loan"),
         words = str_replace_all(words, "massachusettsharvard", "massachusetts harvard"),
         words = str_replace_all(words, "medicalboard", "medical board"),
         words = str_replace_all(words, "ofa", "of a"),
         words = str_replace_all(words, "foundationhas", "foundation has"),
         words = str_replace_all(words, "developmgcountry", "developing-country"),
         words = str_replace_all(words, "contraceptivesand", "contraceptives and"),
         words = str_replace_all(words, "hereworkinprogress", "here work in progress"),
         words = str_replace_all(words, "kcontinued", "k-continued"),
         words = str_replace_all(words, "paymentsmissionary", "payment smissionary"),
         words = str_replace_all(words, "societieshos pitals", "societies hospitals"),
         words = str_replace_all(words, "ofinternational", "of international"),
         words = str_replace_all(words, "thcentury", "th century"),
         words = str_replace_all(words, "thecountry", "the country"),
         words = str_replace_all(words, "thegeneral", "the general"),
         words = str_replace_all(words, "thhealth", "the health"),
         words = str_replace_all(words, "activitiescontinued", "activities continued"),
         words = str_replace_all(words, "developmentcontinued", "development continued"),
         words = str_replace_all(words, "programscontinued", "programs continued"),
         words = str_replace_all(words, "organizationscontinued", "organizations continued"),
         words = str_replace_all(words, "institutionscontinued", "institutions continued"),
         words = str_replace_all(words, "healthcontinued", "health continued"),
         words = str_replace_all(words, "paymentsgeneral", "payments general"),
         words = str_replace_all(words, "payments research", "payments research"),
         words = str_replace_all(words, "dcontinued", "continued"),
         words = str_replace_all(words, "requirementscontinued", "requirements continued"),
         words = str_replace_all(words, "educationalcontinued", "educational continued"),
         words = str_replace_all(words, "schoolcontinued", "school continued"),
         words = str_replace_all(words, "budgetcontinued", "budget continued"),
         words = str_replace_all(words, "countriescontinued", "countries continued"),
         words = str_replace_all(words, "europecontinued", "europe continued"),
         words = str_replace_all(words, "statescontinued", "states continued"),
         words = str_replace_all(words, "paymentspublic", "payments public"),
         words = str_replace_all(words, "centerfor", "center for"),
         words = str_replace_all(words, "sciencebased", "science based"),
         words = str_replace_all(words, "agncultural", "agricultural"),
         words = str_replace_all(words, "costof", "cost of"),
         words = str_replace_all(words, "costsof", "costs of"),
         words = str_replace_all(words, "amencan", "american"),
         words = str_replace_all(words, "capacitybuilding", "capacity building"),
         words = str_replace_all(words, "civilsocietyorganizations", 
                                 "civil society organizations"),
         words = str_replace_all(words, "fouryear", "four year"),
         words = str_replace_all(words, "droughttolerant", "drought tolerant"),
         words = str_replace_all(words, "appbopria", "appropriations"),
         words = str_replace_all(words, "annourices", "announces"),
         words = str_replace_all(words, "developmentand", "development and"),
         words = str_replace_all(words, "foodand", "food and"),
         words = str_replace_all(words, "chma", "china"),
         # words = str_replace_all(words, "nomirices", "nominees"),
         words = str_replace_all(words, "erice$", "ence"),
         words = str_replace_all(words, "erices$", "ences"),
         words = str_replace_all(words, "engiricering", "engineering"),
         words = str_replace_all(words, "coricerning", "concerning"),
         words = str_replace_all(words, "(arice)(.*)", "ance\\2"),
         words = str_replace_all(words, "(erice)(.*)", "ence\\2"),
         words = str_replace_all(words, "(irice)(.*)", "ince\\2"),
         words = str_replace_all(words, "(nomi)ric(.*)", "\\1n\\2"),
         words = str_replace_all(words, "schoololarships", "scholarships"),
         words = str_replace_all(words, "artistinresidence", "artist in residence"),
         words = str_replace_all(words, "byaws", "by-laws"),
         words = str_replace_all(words, "newyorkcity", "new york city"),
         words = str_replace_all(words, "\\barc", "are"),
         words = str_replace_all(words, "afiveearperiod", "a five year period"),
         words = str_replace_all(words, "beview", "review"),
         words = str_replace_all(words, "composernesidence", "composer-in-residence"),
         words = str_replace_all(words, "inervice", "in-service"),
         words = str_replace_all(words, "\\bdesigna\\b", "designations"),
         words = str_replace_all(words, "berlinahlem", "berlin-dahlem"),
         words = str_replace_all(words, "andexplorations", "and explorations"),
         words = str_replace_all(words, "universityof", "university of"),
         words = str_replace_all(words, "ph.d.", "ph.d"),
         words = str_replace_all(words, "associa", "association"),
         words = str_replace_all(words, "\\bbabwe", "zimbabwe"),
         words = str_replace_all(words, "ogyscnpps", "scripps"),
         words = str_replace_all(words, "biotechnol\\b", "biotechnology"),
         words = str_replace_all(words, "sociol\\b", "sociology"),
         words = str_replace_all(words, "coricert", "concert"),
         words = str_replace_all(words, "ourwork", "our work"),
         words = str_replace_all(words, "arehaeology", "archaeology"),
         words = str_replace_all(words, "appbopbia", "appropriation"),
         words = str_replace_all(words, "researeh", "research"), 
         words = str_replace_all(words, "colomb\\b", "colombia"),
         words = str_replace_all(words, "minorityroup", "minority group"),
         words = str_replace_all(words, "artisthesidence", "artist in residence"),
         words = str_replace_all(words, "avantarde", "avantgarde"), 
         words = str_replace_all(words, "associationte", "associate"),
         words = str_replace_all(words, "atisk", "at-risk"),
         words = str_replace_all(words, "-support", "support"),
         words = str_replace_all(words, "-salary", "salary"),
         words = str_replace_all(words, "\\bmex\\.\\b", "mexico"),
         words = str_replace_all(words, "\\bcommis\\b", "commission"),
         words = str_replace_all(words, "\\bconsol\\b", "consolidation"),
         words = str_replace_all(words, "\\bcontribu\\b", "contribution"),
         words = str_replace_all(words, "renfection", "reinfection"),
         words = str_replace_all(words, "\\bpsy\\schiatry", "psychiatry")) %>% 
  filter(!(words %in% c("tory", "tional", "tural", "ture", "cal", "medi", "na", 
                        "cul","©", "v", "f", "r", "p", "e", "t", "l", "m", "n", 
                        "b", "m.s", "na", "fe", "ab", "db", "appbopbu", 
                        "apphopbia", "tionb", "tlona", "$", "mem", "ix", "viii",
                        "sr.", "—a", "sss", "—lh", "—salary", "—support", 
                        "pp", "©rants", "mr", "mr.", "&m", "à", "—dr", "ip", 
                        "ooo", "ps", "da", "b.sc", ".ft", "a.", "sr.", "a.b.", 
                        "a.m.", "univ.", ".v.m", "xmv", "am", "cc", "du", "candi")))


# TODO quoi faire avec ce table? 
table <- kable(head(tokenised.no.punct, 5)) %>%
  kableExtra::kable_styling() %>%
  kableExtra::add_header_above(c("Figure 3: " = 2))

save(tokenised.punct, file = "tokenised.punct.Rda")
save(tokenised.no.punct.nsw, file = "tokenised.no.punct.nsw.Rda")

dc.np.final <- tokenised.no.punct.nsw %>% 
  group_by(Year) %>% 
  summarise(text = paste(words, collapse = " "))

dc.p.final <- tokenised.punct %>% 
  group_by(Year) %>% 
  summarise(text = paste(words, collapse = " "))

save(dc.np.final, file = "dc.np.final.Rda")
save(dc.p.final, file= "dc.p.final.Rda")

# view(name of the object)

# Grouping by year and counting words ----
wordnumperyear <- tokenised.no.punct.nsw %>% 
  group_by(Year) %>% 
  count(words, sort=TRUE) %>% 
  top_n(n = 500, n) %>% 
  ungroup()

# To separate two words that have not been separated before
two_words <- wordnumperyear %>% 
  separate(words, c("FrstWord", "SndWord"), sep = "\\s") %>% 
  filter(!is.na(SndWord)) %>% 
  gather("order", "words", FrstWord, SndWord) %>% 
  select(Year, words, n)

wordnumperyear <- two_words %>% 
  bind_rows(wordnumperyear) %>% 
  filter(!str_detect(words, "\\s|\\-"))

save(wordnumperyear, file = "wordnumperyear.Rda")


wordnumperyear.punct <- tokenised.punct %>% 
  group_by(Year) %>% 
  count(words, sort=TRUE) %>% 
  top_n(n = 500, n)
save(wordnumperyear.punct, file = "wordnumperyear.punct.Rda")

# Creating a table per period for the whole of the corpus ----
table.per.period <- tokenised.no.punct.nsw %>% 
  mutate(period = cut(Year,c(0, 1919, 1929, 1939, 1945, 1955, 1965, 1975, 1985,
                             1995, 2005, 2014), 
                      labels = c("1913-1919", "1920-1929", "1930-1939", "1940-1945",
                                 "1946-1955", "1956-1965", "1966-1975", "1976-1985",
                                 "1986-1995", "1996-2005", "2006-2013")))  %>% 
  group_by(period) %>% 
  count(words) %>% 
  filter(n> 10) 

save(table.per.period, file = "table.per.period.Rda")
# Creating a figure for the top20 words of whole corpus by period
table.per.period %>% 
  top_n(n, n = 20) %>% 
  ggplot(aes(n, reorder_within(words, n, period), group = period))+
  geom_col()+
  facet_wrap(~period, scales = "free_y")+
  scale_y_reordered()+
  labs(y="TOP 20")+
  theme(legend.position = "none") +
  ggtitle("Figure 12: Top 20 words for the whole of the corpus")
ggsave("graph-top20.png", units = "cm", width = 26, height = 30)

# Creating a table per year for the whole of the corpus ----
table.per.year <- tokenised.no.punct.nsw %>% 
  group_by(Year) %>% 
  count(words) %>% 
  filter(n> 15) 

save(table.per.year, file = "table.per.year.Rda")


# # TF-IDF ----
# testtf <- tokenised.no.punct.nsw %>% 
#   group_by(Year) %>% 
#   count(words, sort=TRUE) %>% 
#   top_n(n=100, n) %>% 
#   arrange(Year)
# 
# save(testtf, file = "testtf.Rda")

# Comparing the number of words of early and late reports ----
freq.rep <- summary(corpus(dc.np.final)) %>% 
  select(Text, Tokens, Year)

freq.rep %>% 
  ggplot(aes(Year, Tokens)) +
  geom_line() +
  labs(y = "Number of words",
       title = "Figure 1: Number of Words per Year") +
  theme(legend.position = "none")

ggsave("number.of.words.per.year.png", units = "cm", width = 26, height = 14)


# Retrieving one specific document and one specific word ----
# dc.np.final %>%
#   rowid_to_column("id") %>% 
#   filter(id %in% 78:82) %>% 
#   mutate(check = str_detect(text, "biotechnologyogy"))

# Creating the table for the tidy part 
# library(knitr)
# head_table <- head(data.clean.no.punct, n = 5)
# kable_table <- knitr::kable(head_table)
# print(kable_table)
